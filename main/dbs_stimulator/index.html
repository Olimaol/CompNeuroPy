
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../define_experiment/">
      
      
        <link rel="next" href="../model_configurator/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.14">
    
    
      
        <title>DBS Stimulator - CompNeuroPy</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#CompNeuroPy.dbs.DBSstimulator" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CompNeuroPy" class="md-header__button md-logo" aria-label="CompNeuroPy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CompNeuroPy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DBS Stimulator
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Olimaol/CompNeuroPy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CompNeuroPy" class="md-nav__button md-logo" aria-label="CompNeuroPy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    CompNeuroPy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Olimaol/CompNeuroPy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Main Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Main Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generate_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generate_simulations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Simulations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitors_recordings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitors / Recordings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimize_neuron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimize a neuron model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../define_experiment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Define Experiments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    DBS Stimulator
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    DBS Stimulator
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#CompNeuroPy.dbs.DBSstimulator" class="md-nav__link">
    <span class="md-ellipsis">
      DBSstimulator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DBSstimulator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#CompNeuroPy.dbs.DBSstimulator.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#CompNeuroPy.dbs.DBSstimulator.on" class="md-nav__link">
    <span class="md-ellipsis">
      on()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#CompNeuroPy.dbs.DBSstimulator.off" class="md-nav__link">
    <span class="md-ellipsis">
      off()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#CompNeuroPy.dbs.DBSstimulator.update_pointers" class="md-nav__link">
    <span class="md-ellipsis">
      update_pointers()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model_configurator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Configurator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Built-in Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Built-in Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../built_in/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Full Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../built_in/neuron_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neuron Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../built_in/synapse_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Synapse Models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Additional Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Additional Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../additional/simulation_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulation Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../additional/simulation_requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulation Requirements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../additional/analysis_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analysis Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../additional/model_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../additional/system_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../additional/extra_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extra Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../additional/statistic_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistic Functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/generate_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/run_and_monitor_simulations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Simulations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/monitor_recordings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitor Recordings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/plot_recordings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot Recordings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/experiment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Define Experiments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/dbs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DBS Simulator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/opt_neuron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimize a neuron model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#CompNeuroPy.dbs.DBSstimulator" class="md-nav__link">
    <span class="md-ellipsis">
      DBSstimulator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DBSstimulator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#CompNeuroPy.dbs.DBSstimulator.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#CompNeuroPy.dbs.DBSstimulator.on" class="md-nav__link">
    <span class="md-ellipsis">
      on()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#CompNeuroPy.dbs.DBSstimulator.off" class="md-nav__link">
    <span class="md-ellipsis">
      off()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#CompNeuroPy.dbs.DBSstimulator.update_pointers" class="md-nav__link">
    <span class="md-ellipsis">
      update_pointers()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>DBS Stimulator</h1>

<div class="doc doc-object doc-class">




<h2 id="CompNeuroPy.dbs.DBSstimulator" class="doc doc-heading">
          <code>CompNeuroPy.dbs.DBSstimulator</code>


<a href="#CompNeuroPy.dbs.DBSstimulator" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents first">

  
      <p>Class for stimulating a population with DBS.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you use auto_implement, pointers to the populations and projections of
the model are not valid anymore (new populations and projections are
created)! Use a CompNeuroPy model working with names of populations and
projections anyway (recommended) or use the update_pointers method.</p>
</div>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">ANNarchy</span> <span class="kn">import</span> <span class="n">Population</span><span class="p">,</span> <span class="n">Izhikevich</span><span class="p">,</span> <span class="nb">compile</span><span class="p">,</span> <span class="n">simulate</span><span class="p">,</span> <span class="n">setup</span>
<span class="kn">from</span> <span class="nn">CompNeuroPy</span> <span class="kn">import</span> <span class="n">DBSstimulator</span>

<span class="c1"># setup ANNarchy</span>
<span class="n">setup</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># create populations</span>
<span class="n">population1</span> <span class="o">=</span> <span class="n">Population</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">neuron</span><span class="o">=</span><span class="n">Izhikevich</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_pop1&quot;</span><span class="p">)</span>
<span class="n">population2</span> <span class="o">=</span> <span class="n">Population</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">neuron</span><span class="o">=</span><span class="n">Izhikevich</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_pop2&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="c1"># create DBS stimulator</span>
<span class="n">dbs</span> <span class="o">=</span> <span class="n">DBSstimulator</span><span class="p">(</span>
    <span class="n">stimulated_population</span><span class="o">=</span><span class="n">population1</span><span class="p">,</span>
    <span class="n">population_proportion</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">dbs_depolarization</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">auto_implement</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># update pointers to correct populations</span>
<span class="n">population1</span><span class="p">,</span> <span class="n">population2</span> <span class="o">=</span> <span class="n">dbs</span><span class="o">.</span><span class="n">update_pointers</span><span class="p">(</span>
    <span class="n">pointer_list</span><span class="o">=</span><span class="p">[</span><span class="n">population1</span><span class="p">,</span> <span class="n">population2</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># compile network</span>
<span class="nb">compile</span><span class="p">()</span>

<span class="c1"># run simulation</span>
<span class="c1"># 1000 ms without dbs</span>
<span class="n">simulate</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># 1000 ms with dbs</span>
<span class="n">dbs</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
<span class="n">simulate</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># 1000 ms without dbs</span>
<span class="n">dbs</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
<span class="n">simulate</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>src/CompNeuroPy/dbs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DBSstimulator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for stimulating a population with DBS.</span>

<span class="sd">    !!! warning</span>
<span class="sd">        If you use auto_implement, pointers to the populations and projections of</span>
<span class="sd">        the model are not valid anymore (new populations and projections are</span>
<span class="sd">        created)! Use a CompNeuroPy model working with names of populations and</span>
<span class="sd">        projections anyway (recommended) or use the update_pointers method.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        from ANNarchy import Population, Izhikevich, compile, simulate, setup</span>
<span class="sd">        from CompNeuroPy import DBSstimulator</span>

<span class="sd">        # setup ANNarchy</span>
<span class="sd">        setup(dt=0.1)</span>

<span class="sd">        # create populations</span>
<span class="sd">        population1 = Population(10, neuron=Izhikevich, name=&quot;my_pop1&quot;)</span>
<span class="sd">        population2 = Population(10, neuron=Izhikevich, name=&quot;my_pop2&quot;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        # create DBS stimulator</span>
<span class="sd">        dbs = DBSstimulator(</span>
<span class="sd">            stimulated_population=population1,</span>
<span class="sd">            population_proportion=0.5,</span>
<span class="sd">            dbs_depolarization=30,</span>
<span class="sd">            auto_implement=True,</span>
<span class="sd">        )</span>

<span class="sd">        # update pointers to correct populations</span>
<span class="sd">        population1, population2 = dbs.update_pointers(</span>
<span class="sd">            pointer_list=[population1, population2]</span>
<span class="sd">        )</span>

<span class="sd">        # compile network</span>
<span class="sd">        compile()</span>

<span class="sd">        # run simulation</span>
<span class="sd">        # 1000 ms without dbs</span>
<span class="sd">        simulate(1000)</span>
<span class="sd">        # 1000 ms with dbs</span>
<span class="sd">        dbs.on()</span>
<span class="sd">        simulate(1000)</span>
<span class="sd">        # 1000 ms without dbs</span>
<span class="sd">        dbs.off()</span>
<span class="sd">        simulate(1000)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@check_types</span><span class="p">()</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">stimulated_population</span><span class="p">:</span> <span class="n">Population</span><span class="p">,</span>
        <span class="n">population_proportion</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">excluded_populations_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Population</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">dbs_depolarization</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">orthodromic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">antidromic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">efferents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">afferents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">passing_fibres</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">passing_fibres_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Projection</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">passing_fibres_strength</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">sum_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">dbs_pulse_frequency_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">130.0</span><span class="p">,</span>
        <span class="n">dbs_pulse_width_us</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">300.0</span><span class="p">,</span>
        <span class="n">axon_spikes_per_pulse</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">axon_rate_amp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Population</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">auto_implement</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">generate_model</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize DBS stimulator.</span>

<span class="sd">        !!! warning</span>
<span class="sd">            Do this before compiling the model!</span>

<span class="sd">        Args:</span>
<span class="sd">            stimulated_population (Population):</span>
<span class="sd">                Population which is stimulated by DBS</span>
<span class="sd">            population_proportion (float, optional):</span>
<span class="sd">                Proportion of the stimulated population which is affected by DBS,</span>
<span class="sd">                neurons are distributed randomly. Default: 1.0.</span>
<span class="sd">            excluded_populations_list (list, optional):</span>
<span class="sd">                List of populations which are excluded from DBS effects, they are not</span>
<span class="sd">                affected and their axons do not generate axon spikes. Default: [].</span>
<span class="sd">            dbs_depolarization (float, optional):</span>
<span class="sd">                Depolarization effect of the DBS pulse to local soma. Default: 0.0.</span>
<span class="sd">            orthodromic (bool, optional):</span>
<span class="sd">                If True, DBS causes axonal spikes which are forwarded orthodromically.</span>
<span class="sd">                Default: False.</span>
<span class="sd">            antidromic (bool, optional):</span>
<span class="sd">                If True, DBS causes axonal spikes which are forwarded antidromically,</span>
<span class="sd">                only available in spiking networks. Default: False.</span>
<span class="sd">            efferents (bool, optional):</span>
<span class="sd">                If True, DBS affects the efferents of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too). Default: False.</span>
<span class="sd">            afferents (bool, optional):</span>
<span class="sd">                If True, DBS affects the afferents of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too). Default: False.</span>
<span class="sd">            passing_fibres (bool, optional):</span>
<span class="sd">                If True, DBS affects the passing fibres of the stimulated region defined</span>
<span class="sd">                in passing_fibres_list (orthodromic and/or antidromic have to be True</span>
<span class="sd">                too). Default: False.</span>
<span class="sd">            passing_fibres_list (list of Projections, optional):</span>
<span class="sd">                List of projections which pass the DBS stimulated region and therefore</span>
<span class="sd">                are activated by DBS. Default: [], also set passing_fibres True!</span>
<span class="sd">            passing_fibres_strength (float or list of float, optional):</span>
<span class="sd">                Single value or list of float values between 0 and 1 defining how strong</span>
<span class="sd">                the passing fibres are activated by DBS (0: not activated, 1: fully</span>
<span class="sd">                activated like the projections in the DBS stimulated region).</span>
<span class="sd">                Default: 1.</span>
<span class="sd">            sum_branches (bool, optional):</span>
<span class="sd">                If True, the antidromic_prob of a presynaptic population (defining how</span>
<span class="sd">                many axon spikes affect the pop antidromically) of passing fibres is</span>
<span class="sd">                the sum of the passing_fibres_strengths of the single axon branches.</span>
<span class="sd">                Default: True.</span>
<span class="sd">            dbs_pulse_frequency_Hz (float, optional):</span>
<span class="sd">                Frequency of the DBS pulse. Default: 130 Hz.</span>
<span class="sd">            dbs_pulse_width_us (float, optional):</span>
<span class="sd">                Width of the DBS pulse. Default: 300 us.</span>
<span class="sd">            axon_spikes_per_pulse (float, optional):</span>
<span class="sd">                Number of average axon spikes per DBS pulse. Default: 1.</span>
<span class="sd">            axon_rate_amp (float or dict of float, optional):</span>
<span class="sd">                Similar to prob_axon_spike in spiking model. Which rate is forwarded on</span>
<span class="sd">                axons caused by DBS. You can specify this for each population</span>
<span class="sd">                individually by using a dictionary (keys = Population instances)</span>
<span class="sd">                axon_rate_amp = {pop: 1.5} --&gt; the efferent axons of pop forward a rate</span>
<span class="sd">                of 1.5 during DBS (all other affected projections forward the default</span>
<span class="sd">                value)</span>
<span class="sd">                You can specify the default value by using the key &quot;default&quot;, e.g.</span>
<span class="sd">                {pop: 1.5, &quot;default&quot;: 1.0} -&gt; efferent axons of all populations except</span>
<span class="sd">                pop forward a rate of 1.0 during DBS. Default: 1.0.</span>
<span class="sd">            seed (int, optional):</span>
<span class="sd">                Seed for the random distribution of affected neurons based on</span>
<span class="sd">                population_proportion. Default: None.</span>
<span class="sd">            auto_implement (bool, optional):</span>
<span class="sd">                If True, automatically implement DBS mechanisms to the model. Only</span>
<span class="sd">                supported for Izhikevich spiking models and rate-coded models.</span>
<span class="sd">                Default: False.</span>
<span class="sd">                TODO test what happens with mixed models</span>
<span class="sd">            model (generate_model, optional):</span>
<span class="sd">                CompNeuroPy model which is used to automatically implement DBS</span>
<span class="sd">                mechanisms, should not be compiled!. Default: None, i.e., use all</span>
<span class="sd">                populations and projections of the current magic model</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">auto_implement</span><span class="p">:</span>
            <span class="c1">### recreate model with DBS mechanisms</span>
            <span class="c1">### give all variables containing Populations and Projections</span>
            <span class="c1">### and also recreate them during recreating the model</span>
            <span class="c1">### variables are:</span>
            <span class="c1">### - stimulated_population</span>
            <span class="c1">### - excluded_populations_list</span>
            <span class="c1">### - passing_fibres_list</span>
            <span class="c1">### - axon_rate_amp</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                <span class="c1">### CompNeuroPy model given</span>
                <span class="c1">### recreate model with DBS mechanisms</span>
                <span class="n">create_dbs_model_obj</span> <span class="o">=</span> <span class="n">_CreateDBSmodelcnp</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span>
                    <span class="n">stimulated_population</span><span class="p">,</span>
                    <span class="n">excluded_populations_list</span><span class="p">,</span>
                    <span class="n">passing_fibres_list</span><span class="p">,</span>
                    <span class="n">axon_rate_amp</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="c1">### get the new CompNeuroPy model</span>
                <span class="n">model</span> <span class="o">=</span> <span class="n">create_dbs_model_obj</span><span class="o">.</span><span class="n">model</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">### no CompNeuroPy model given --&gt; use all populations and projections of the current magic model</span>
                <span class="c1">### recreate model with DBS mechanisms</span>
                <span class="n">create_dbs_model_obj</span> <span class="o">=</span> <span class="n">_CreateDBSmodel</span><span class="p">(</span>
                    <span class="n">stimulated_population</span><span class="p">,</span>
                    <span class="n">excluded_populations_list</span><span class="p">,</span>
                    <span class="n">passing_fibres_list</span><span class="p">,</span>
                    <span class="n">axon_rate_amp</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="c1">### get the new variables containing Populations and Projections</span>
            <span class="n">stimulated_population</span> <span class="o">=</span> <span class="n">create_dbs_model_obj</span><span class="o">.</span><span class="n">stimulated_population</span>
            <span class="n">excluded_populations_list</span> <span class="o">=</span> <span class="n">create_dbs_model_obj</span><span class="o">.</span><span class="n">excluded_populations_list</span>
            <span class="n">passing_fibres_list</span> <span class="o">=</span> <span class="n">create_dbs_model_obj</span><span class="o">.</span><span class="n">passing_fibres_list</span>
            <span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="n">create_dbs_model_obj</span><span class="o">.</span><span class="n">axon_rate_amp</span>

        <span class="c1">### set parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stimulated_population</span> <span class="o">=</span> <span class="n">stimulated_population</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">population_proportion</span> <span class="o">=</span> <span class="n">population_proportion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">excluded_populations_list</span> <span class="o">=</span> <span class="n">excluded_populations_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbs_depolarization</span> <span class="o">=</span> <span class="n">dbs_depolarization</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orthodromic</span> <span class="o">=</span> <span class="n">orthodromic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antidromic</span> <span class="o">=</span> <span class="n">antidromic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">efferents</span> <span class="o">=</span> <span class="n">efferents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">afferents</span> <span class="o">=</span> <span class="n">afferents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres</span> <span class="o">=</span> <span class="n">passing_fibres</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres_list</span> <span class="o">=</span> <span class="n">passing_fibres_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres_strength</span> <span class="o">=</span> <span class="n">passing_fibres_strength</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sum_branches</span> <span class="o">=</span> <span class="n">sum_branches</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbs_pulse_width_us</span> <span class="o">=</span> <span class="n">dbs_pulse_width_us</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axon_spikes_per_pulse</span> <span class="o">=</span> <span class="n">axon_spikes_per_pulse</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="n">axon_rate_amp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

        <span class="c1">### ANNarchy constants for DBS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_constants</span><span class="p">(</span><span class="n">dbs_pulse_frequency_Hz</span><span class="p">)</span>

        <span class="c1">### randomly select affected neurons i.e. create dbs_on_array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbs_on_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dbs_on_array</span><span class="p">(</span><span class="n">population_proportion</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_dbs_on_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population_proportion</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an array with the shape of the stimulated population with ones and zeros</span>
<span class="sd">        randomly distributed with the specified population_proportion.</span>

<span class="sd">        Args:</span>
<span class="sd">            population_proportion (float):</span>
<span class="sd">                Proportion of the stimulated population which is affected by DBS,</span>
<span class="sd">                neurons are distributed randomly</span>
<span class="sd">            seed (int):</span>
<span class="sd">                Seed for the random distribution of affected neurons based on</span>
<span class="sd">                population_proportion</span>

<span class="sd">        Returns:</span>
<span class="sd">            dbs_on_array (np.array):</span>
<span class="sd">                Array with the shape of the stimulated population with ones and zeros</span>
<span class="sd">                randomly distributed with the specified population_proportion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">### create random number generator</span>
        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="c1">### create an array of zeros with the shape of the population, then flatten it</span>
        <span class="n">dbs_on_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stimulated_population</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="c1">### get the number of affected neurons based on the population_proportion</span>
        <span class="n">number_of_affected_neurons</span> <span class="o">=</span> <span class="n">population_proportion</span> <span class="o">*</span> <span class="n">dbs_on_array</span><span class="o">.</span><span class="n">size</span>
        <span class="c1">### randomly ceil or floor the number of affected neurons</span>
        <span class="n">number_of_affected_neurons</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">number_of_affected_neurons</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">number_of_affected_neurons</span><span class="p">),</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1">### insert ones to the dbs_on_array</span>
        <span class="n">dbs_on_array</span><span class="p">[:</span><span class="n">number_of_affected_neurons</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1">### shuffle array</span>
        <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">dbs_on_array</span><span class="p">)</span>
        <span class="c1">### reshape array to the shape of the population</span>
        <span class="n">dbs_on_array</span> <span class="o">=</span> <span class="n">dbs_on_array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stimulated_population</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>
        <span class="c1">### return array</span>
        <span class="k">return</span> <span class="n">dbs_on_array</span>

    <span class="k">def</span> <span class="nf">_set_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbs_pulse_frequency_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set constants for DBS.</span>

<span class="sd">        Args:</span>
<span class="sd">            dbs_pulse_frequency_Hz (float):</span>
<span class="sd">                Frequency of the DBS pulse in Hz</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pulse frequency:</span>
        <span class="n">Constant</span><span class="p">(</span><span class="s2">&quot;dbs_pulse_frequency_Hz&quot;</span><span class="p">,</span> <span class="n">dbs_pulse_frequency_Hz</span><span class="p">)</span>
        <span class="c1"># pulse width:</span>
        <span class="c1"># Neumant et al.. 2023: 60us but Meier et al. 2022: 300us... 60us = 0.06ms is very small for ANNarchy simulations</span>
        <span class="n">Constant</span><span class="p">(</span><span class="s2">&quot;dbs_pulse_width_us&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbs_pulse_width_us</span><span class="p">)</span>

        <span class="c1">### add global function for DBS pulse</span>
        <span class="n">add_function</span><span class="p">(</span>
            <span class="s2">&quot;pulse(time_ms) = ite(modulo(time_ms*1000, 1000000./dbs_pulse_frequency_Hz) &lt; dbs_pulse_width_us, 1., 0.)&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_axon_spikes_per_pulse_to_prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axon_spikes_per_pulse</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert number of axon spikes per pulse to probability of axon spikes per</span>
<span class="sd">        timestep during DBS pulse</span>

<span class="sd">        Args:</span>
<span class="sd">            axon_spikes_per_pulse (float):</span>
<span class="sd">                Number of average axon spikes per DBS pulse</span>

<span class="sd">        Returns:</span>
<span class="sd">            prob_axon_spike_time_step (float):</span>
<span class="sd">                Probability of axon spikes per timestep during DBS pulse</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span>
            <span class="p">(</span><span class="n">axon_spikes_per_pulse</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">dt</span><span class="p">()</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbs_pulse_width_us</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_depolarization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbs_depolarization</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set depolarization of population.</span>

<span class="sd">        Args:</span>
<span class="sd">            dbs_depolarization (float, optional):</span>
<span class="sd">                Depolarization effect of the DBS pulse to local soma. Default: None,</span>
<span class="sd">                i.e., use value from initialization</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">### either use given depolarization or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dbs_depolarization</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">dbs_depolarization</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbs_depolarization</span>

        <span class="c1">### set depolarization of population</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">populations</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">pop</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">stimulated_population</span><span class="p">:</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">dbs_depolarization</span> <span class="o">=</span> <span class="n">dbs_depolarization</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">dbs_depolarization</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_set_axon_spikes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">orthodromic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">antidromic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">efferents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">afferents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">passing_fibres</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">passing_fibres_strength</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sum_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">axon_spikes_per_pulse</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">axon_rate_amp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Population</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set axon spikes forwarding orthodromic</span>

<span class="sd">        Args:</span>
<span class="sd">            orthodromic (bool, optional):</span>
<span class="sd">                If True, DBS causes axonal spikes which are forwarded orthodromically,</span>
<span class="sd">                Default: None, i.e., use value from initialization</span>
<span class="sd">            antidromic (bool, optional):</span>
<span class="sd">                If True, DBS causes axonal spikes which are forwarded antidromically,</span>
<span class="sd">                only available in spiking networks. Default: None, i.e., use value from</span>
<span class="sd">                initialization</span>
<span class="sd">            efferents (bool, optional):</span>
<span class="sd">                If True, DBS affects the efferents of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too). Default: None,</span>
<span class="sd">                i.e., use value from initialization</span>
<span class="sd">            afferents (bool, optional):</span>
<span class="sd">                If True, DBS affects the afferents of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too). Default: None,</span>
<span class="sd">                i.e., use value from initialization</span>
<span class="sd">            passing_fibres (bool, optional):</span>
<span class="sd">                If True, DBS affects the passing fibres of the stimulated region defined</span>
<span class="sd">                in passing_fibres_list (orthodromic and/or antidromic have to be True</span>
<span class="sd">                too). Default: None, i.e., use value from initialization</span>
<span class="sd">            passing_fibres_strength (float | list[float], optional):</span>
<span class="sd">                Single value or list of float values between 0 and 1 defining how strong</span>
<span class="sd">                the passing fibres are activated by DBS (0: not activated, 1: fully</span>
<span class="sd">                activated like the projections in the DBS stimulated region).</span>
<span class="sd">                Default: None, i.e., use value from initialization</span>
<span class="sd">            sum_branches (bool, optional):</span>
<span class="sd">                If True, the antidromic_prob of a presynaptic population (defining how</span>
<span class="sd">                many axon spikes affect the pop antidromically) of passing fibres is</span>
<span class="sd">                the sum of the passing_fibres_strengths of the single axon branches.</span>
<span class="sd">                Default: None, i.e., use value from initialization</span>
<span class="sd">            axon_spikes_per_pulse (float, optional):</span>
<span class="sd">                Number of average axon spikes per DBS pulse. Default: None, i.e., use</span>
<span class="sd">                value from initialization</span>
<span class="sd">            axon_rate_amp (float | dict[Population | str, float], optional):</span>
<span class="sd">                Similar to prob_axon_spike in spiking model. Which rate is forwarded on</span>
<span class="sd">                axons caused by DBS. You can specify this for each population</span>
<span class="sd">                individually by using a dictionary (keys = Population instances)</span>
<span class="sd">                axon_rate_amp = {pop: 1.5} --&gt; the efferent axons of pop forward a rate</span>
<span class="sd">                of 1.5 during DBS (all other affected projections forward the default</span>
<span class="sd">                value)</span>
<span class="sd">                You can specify the default value by using the key &quot;default&quot;, e.g.</span>
<span class="sd">                {pop: 1.5, &quot;default&quot;: 1.0} -&gt; efferent axons of all populations except</span>
<span class="sd">                pop forward a rate of 1.0 during DBS. Default: None, i.e., use value</span>
<span class="sd">                from initialization</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">### either use given orthodromic or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">orthodromic</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">orthodromic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orthodromic</span>
        <span class="c1">### either use given antidromic or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">antidromic</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">antidromic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">antidromic</span>
        <span class="c1">### either use given efferents or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">efferents</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">efferents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">efferents</span>
        <span class="c1">### either use given afferents or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">afferents</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">afferents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">afferents</span>
        <span class="c1">### either use given afferents or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">passing_fibres</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">passing_fibres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres</span>
        <span class="c1">### either use given passing_fibres_strength or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">passing_fibres_strength</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">passing_fibres_strength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres_strength</span>
        <span class="c1">### either use given sum_branches or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sum_branches</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">sum_branches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_branches</span>
        <span class="c1">### either use given axon_spikes_per_pulse or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axon_spikes_per_pulse</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">axon_spikes_per_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axon_spikes_per_pulse</span>
        <span class="c1">### either use given axon_rate_amp or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axon_rate_amp</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axon_rate_amp</span>

        <span class="c1">### check if passing_fibres_strength is a list</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">passing_fibres_strength</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">passing_fibres_strength</span> <span class="o">=</span> <span class="p">[</span><span class="n">passing_fibres_strength</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres_list</span>
            <span class="p">)</span>
        <span class="c1">### check if axon_rate_amp is a dict or float</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axon_rate_amp</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1">### check if default key is missing</span>
            <span class="k">if</span> <span class="s2">&quot;default&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">axon_rate_amp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1">### add the key &quot;default&quot; with the value 1.0 to the dict</span>
                <span class="n">axon_rate_amp</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">### create dict with default value</span>
            <span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">axon_rate_amp</span><span class="p">}</span>

        <span class="c1">### deactivate DBS axon transmission</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_deactivate_axon_DBS</span><span class="p">()</span>

        <span class="c1">### activate orthodromic transmission for all projections</span>
        <span class="k">if</span> <span class="n">orthodromic</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_orthodromic</span><span class="p">(</span>
                <span class="n">efferents</span><span class="p">,</span>
                <span class="n">afferents</span><span class="p">,</span>
                <span class="n">passing_fibres</span><span class="p">,</span>
                <span class="n">passing_fibres_strength</span><span class="p">,</span>
                <span class="n">axon_spikes_per_pulse</span><span class="p">,</span>
                <span class="n">axon_rate_amp</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1">### activate antidromic transmission for all populations</span>
        <span class="k">if</span> <span class="n">antidromic</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_antidromic</span><span class="p">(</span>
                <span class="n">efferents</span><span class="p">,</span>
                <span class="n">afferents</span><span class="p">,</span>
                <span class="n">passing_fibres</span><span class="p">,</span>
                <span class="n">passing_fibres_strength</span><span class="p">,</span>
                <span class="n">sum_branches</span><span class="p">,</span>
                <span class="n">axon_spikes_per_pulse</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_deactivate_axon_DBS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deactivate axon spikes forwarding for both orthodromic and antidromic.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">populations</span><span class="p">():</span>
            <span class="c1">### deactivate axon spike genearation for all populations</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">prob_axon_spike</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1">### deactivate antidromic transmission for all populations</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">antidromic</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">antidromic_prob</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1">### deactivate orthodromic transmission for all projections</span>
        <span class="k">for</span> <span class="n">proj</span> <span class="ow">in</span> <span class="n">projections</span><span class="p">():</span>
            <span class="n">proj</span><span class="o">.</span><span class="n">axon_transmission</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">proj</span><span class="o">.</span><span class="n">p_axon_spike_trans</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_set_orthodromic</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">efferents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">afferents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">passing_fibres</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">passing_fibres_strength</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
        <span class="n">axon_spikes_per_pulse</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">axon_rate_amp</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Population</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set orthodromic axon spikes forwarding.</span>

<span class="sd">        Args:</span>
<span class="sd">            efferents (bool):</span>
<span class="sd">                If True, DBS affects the efferents of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too)</span>
<span class="sd">            afferents (bool):</span>
<span class="sd">                If True, DBS affects the afferents of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too)</span>
<span class="sd">            passing_fibres (bool):</span>
<span class="sd">                If True, DBS affects the passing fibres of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too and there have to</span>
<span class="sd">                be passing fibres in the passing_fibres_list)</span>
<span class="sd">            passing_fibres_strength (list[float]):</span>
<span class="sd">                List of float values between 0 and 1 defining how strong the passing</span>
<span class="sd">                fibres are activated by DBS (0: not activated, 1: fully activated</span>
<span class="sd">                like projections in DBS stimulated region)</span>
<span class="sd">            axon_spikes_per_pulse (float):</span>
<span class="sd">                Number of average axon spikes per DBS pulse</span>
<span class="sd">            axon_rate_amp (dict[Population | str, float]):</span>
<span class="sd">                Similar to prob_axon_spike in spiking model. Which rate is forwarded</span>
<span class="sd">                on axons caused by DBS. The dictionary has to contain the key</span>
<span class="sd">                &quot;default&quot; with the default value for all projections and can contain</span>
<span class="sd">                keys for each population with a different value for the axon_rate of</span>
<span class="sd">                the efferent axons of this population.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">efferents</span><span class="p">:</span>
            <span class="c1">### activate all efferent projections</span>
            <span class="n">projection_list</span> <span class="o">=</span> <span class="n">projections</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stimulated_population</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">proj</span> <span class="ow">in</span> <span class="n">projection_list</span><span class="p">:</span>
                <span class="c1">### skip excluded populations</span>
                <span class="k">if</span> <span class="n">proj</span><span class="o">.</span><span class="n">post</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excluded_populations_list</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1">### activate axon transmission</span>
                <span class="n">proj</span><span class="o">.</span><span class="n">axon_transmission</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">proj</span><span class="o">.</span><span class="n">p_axon_spike_trans</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1">### set prob_axon_spike for spiking model</span>
                <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">prob_axon_spike</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axon_spikes_per_pulse_to_prob</span><span class="p">(</span>
                    <span class="n">axon_spikes_per_pulse</span>
                <span class="p">)</span>
                <span class="c1">### set axon_rate_amp for rate-coded model</span>
                <span class="k">if</span> <span class="n">proj</span><span class="o">.</span><span class="n">pre</span> <span class="ow">in</span> <span class="n">axon_rate_amp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="c1">### axon_rate_amp is specified for this population</span>
                    <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="n">axon_rate_amp</span><span class="p">[</span><span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">### axon_rate_amp is not specified for this population, use default value</span>
                    <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="n">axon_rate_amp</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">afferents</span><span class="p">:</span>
            <span class="c1">### activate all afferent projections</span>
            <span class="n">projection_list</span> <span class="o">=</span> <span class="n">projections</span><span class="p">(</span><span class="n">post</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stimulated_population</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">proj</span> <span class="ow">in</span> <span class="n">projection_list</span><span class="p">:</span>
                <span class="c1">### skip excluded populations</span>
                <span class="k">if</span> <span class="n">proj</span><span class="o">.</span><span class="n">pre</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excluded_populations_list</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1">### activate axon transmission</span>
                <span class="n">proj</span><span class="o">.</span><span class="n">axon_transmission</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">proj</span><span class="o">.</span><span class="n">p_axon_spike_trans</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1">### set prob_axon_spike for spiking model</span>
                <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">prob_axon_spike</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axon_spikes_per_pulse_to_prob</span><span class="p">(</span>
                    <span class="n">axon_spikes_per_pulse</span>
                <span class="p">)</span>
                <span class="c1">### set axon_rate_amp for rate-coded model</span>
                <span class="k">if</span> <span class="n">proj</span><span class="o">.</span><span class="n">pre</span> <span class="ow">in</span> <span class="n">axon_rate_amp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="c1">### axon_rate_amp is specified for this population</span>
                    <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="n">axon_rate_amp</span><span class="p">[</span><span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">### axon_rate_amp is not specified for this population, use default value</span>
                    <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="n">axon_rate_amp</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">passing_fibres</span><span class="p">:</span>
            <span class="c1">### activate all passing projections</span>
            <span class="k">for</span> <span class="n">proj_idx</span><span class="p">,</span> <span class="n">proj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres_list</span><span class="p">):</span>
                <span class="n">proj</span><span class="o">.</span><span class="n">axon_transmission</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">proj</span><span class="o">.</span><span class="n">p_axon_spike_trans</span> <span class="o">=</span> <span class="n">passing_fibres_strength</span><span class="p">[</span><span class="n">proj_idx</span><span class="p">]</span>
                <span class="c1">### set prob_axon_spike for spiking model</span>
                <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">prob_axon_spike</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axon_spikes_per_pulse_to_prob</span><span class="p">(</span>
                    <span class="n">axon_spikes_per_pulse</span>
                <span class="p">)</span>
                <span class="c1">### set axon_rate_amp for rate-coded model</span>
                <span class="k">if</span> <span class="n">proj</span><span class="o">.</span><span class="n">pre</span> <span class="ow">in</span> <span class="n">axon_rate_amp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="c1">### axon_rate_amp is specified for this population</span>
                    <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="n">axon_rate_amp</span><span class="p">[</span><span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">### axon_rate_amp is not specified for this population, use default value</span>
                    <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="n">axon_rate_amp</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_set_antidromic</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">efferents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">afferents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">passing_fibres</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">passing_fibres_strength</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
        <span class="n">sum_branches</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">axon_spikes_per_pulse</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set antidromic axon spikes forwarding.</span>

<span class="sd">        Args:</span>
<span class="sd">            efferents (bool):</span>
<span class="sd">                If True, DBS affects the efferents of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too)</span>
<span class="sd">            afferents (bool):</span>
<span class="sd">                If True, DBS affects the afferents of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too)</span>
<span class="sd">            passing_fibres (bool):</span>
<span class="sd">                If True, DBS affects the passing fibres of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too and there have to</span>
<span class="sd">                be passing fibres in the passing_fibres_list)</span>
<span class="sd">            passing_fibres_strength (list[float]):</span>
<span class="sd">                List of float values between 0 and 1 defining how strong the passing</span>
<span class="sd">                fibres are activated by DBS (0: not activated, 1: fully activated</span>
<span class="sd">                like projections in DBS stimulated region)</span>
<span class="sd">            sum_branches (bool):</span>
<span class="sd">                If True, the antidromic_prob of a presynaptic population (defining how</span>
<span class="sd">                many axon spikes affect the pop antidromically) of passing fibres is</span>
<span class="sd">                the sum of the passing_fibres_strengths of the single axon branches.</span>
<span class="sd">            axon_spikes_per_pulse (float):</span>
<span class="sd">                Number of average axon spikes per DBS pulse</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">efferents</span><span class="p">:</span>
            <span class="c1">### activate all efferent projections, i.e. antodromic activation of stimulated population</span>
            <span class="n">pop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stimulated_population</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">antidromic</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">antidromic_prob</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">prob_axon_spike</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axon_spikes_per_pulse_to_prob</span><span class="p">(</span>
                <span class="n">axon_spikes_per_pulse</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">afferents</span><span class="p">:</span>
            <span class="c1">### activate all afferent projections, i.e. all presynaptic populations of stimulated population</span>
            <span class="c1">### get presynaptic projections</span>
            <span class="n">projection_list</span> <span class="o">=</span> <span class="n">projections</span><span class="p">(</span><span class="n">post</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stimulated_population</span><span class="p">)</span>
            <span class="c1">### get presynaptic populations from projections</span>
            <span class="n">presyn_pop_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">presyn_pop_name_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">proj</span> <span class="ow">in</span> <span class="n">projection_list</span><span class="p">:</span>
                <span class="c1">### skip excluded populations</span>
                <span class="k">if</span> <span class="n">proj</span><span class="o">.</span><span class="n">pre</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excluded_populations_list</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1">### check if presynaptic population is already in list</span>
                <span class="k">if</span> <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">presyn_pop_name_list</span><span class="p">:</span>
                    <span class="n">presyn_pop_name_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="n">presyn_pop_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="p">)</span>
            <span class="c1">### set antidromic for all presynaptic populations</span>
            <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">presyn_pop_list</span><span class="p">:</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">antidromic</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">antidromic_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stimulated_population</span><span class="o">.</span><span class="n">dbs_on</span><span class="p">)</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">prob_axon_spike</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axon_spikes_per_pulse_to_prob</span><span class="p">(</span>
                    <span class="n">axon_spikes_per_pulse</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="n">passing_fibres</span><span class="p">:</span>
            <span class="c1">### get presynaptic populations from passing fibres projections</span>
            <span class="n">presyn_pop_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">presyn_pop_name_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">proj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres_list</span><span class="p">:</span>
                <span class="c1">### check if presynaptic population is already in list</span>
                <span class="k">if</span> <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">presyn_pop_name_list</span><span class="p">:</span>
                    <span class="n">presyn_pop_name_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="n">presyn_pop_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="p">)</span>
            <span class="c1">### get antidomic_prob for each presynatic population with the passing_fibres_strength</span>
            <span class="n">antidromic_prob_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">presyn_pop_list</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pop_idx</span><span class="p">,</span> <span class="n">pop</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">presyn_pop_list</span><span class="p">):</span>
                <span class="c1">### get all passing fibres and their strength of a presynaptic pop</span>
                <span class="n">passing_fibres_strength_of_pop_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">proj_idx</span><span class="p">,</span> <span class="n">proj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres_list</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">proj</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                        <span class="n">passing_fibres_strength_of_pop_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">passing_fibres_strength</span><span class="p">[</span><span class="n">proj_idx</span><span class="p">]</span>
                        <span class="p">)</span>
                <span class="c1">### check if the probs of the single axon branches should be summed up</span>
                <span class="c1">### if for example a presynaptic pop contributes to two passing fibres, the axons of the presynaptic pop split up into two branches</span>
                <span class="c1">### thus, if these two branches are both stimulated, they both forward APs antidromic</span>
                <span class="c1">### thus, sum up the antidromic_prob of the single branches to obtain the antidromic spikes which affect the presynaptic pop</span>
                <span class="c1">### if sum_branches is False, then this would represent that the stimulation at the axon is before it splits up into multiple branches and there should not be different passing_fibres_strengths for the same presynaptic pop</span>
                <span class="k">if</span> <span class="n">sum_branches</span><span class="p">:</span>
                    <span class="n">antidromic_prob_list</span><span class="p">[</span><span class="n">pop_idx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                        <span class="n">passing_fibres_strength_of_pop_list</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">passing_fibres_strength_of_pop_list</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="c1">### list contains different values</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;Different passing fibres strengths for the same presynaptic population detected. This is not possible if sum_branches is False.&quot;</span>
                        <span class="p">)</span>
                    <span class="c1">### all values are the same, thus take the first one</span>
                    <span class="n">antidromic_prob_list</span><span class="p">[</span><span class="n">pop_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">passing_fibres_strength_of_pop_list</span><span class="p">[</span>
                        <span class="mi">0</span>
                    <span class="p">]</span>

                <span class="c1">### TODO</span>
                <span class="c1">### if summing axon branches leads to a prob &gt; 1, then</span>
                <span class="c1">### the prob should be set to 1</span>
                <span class="c1">### the axon spike generation in this pop should be increased</span>
                <span class="c1">### and all axon spike transmissions from this pop should be decreased by the same factor</span>
                <span class="c1">### this is not implemented yet... maybe in the future</span>
                <span class="k">if</span> <span class="n">antidromic_prob_list</span><span class="p">[</span><span class="n">pop_idx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Summing the passing fibres strengths of a presynaptic population leads to a antidromic spike probability &gt; 1. This is not possible yet.&quot;</span>
                    <span class="p">)</span>

            <span class="c1">### set antidromic for all presynaptic populations</span>
            <span class="k">for</span> <span class="n">pop_idx</span><span class="p">,</span> <span class="n">pop</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">presyn_pop_list</span><span class="p">):</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">antidromic</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">antidromic_prob</span> <span class="o">=</span> <span class="n">antidromic_prob_list</span><span class="p">[</span><span class="n">pop_idx</span><span class="p">]</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">prob_axon_spike</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axon_spikes_per_pulse_to_prob</span><span class="p">(</span>
                    <span class="n">axon_spikes_per_pulse</span>
                <span class="p">)</span>

    <span class="nd">@check_types</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">population_proportion</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dbs_depolarization</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">orthodromic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">antidromic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">efferents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">afferents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">passing_fibres</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">passing_fibres_strength</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sum_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">axon_spikes_per_pulse</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">axon_rate_amp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Population</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Activate DBS.</span>

<span class="sd">        Args:</span>
<span class="sd">            population_proportion (float, optional):</span>
<span class="sd">                Proportion of the stimulated population which is affected by DBS,</span>
<span class="sd">                neurons are distributed randomly. Default: None, i.e., use value from</span>
<span class="sd">                initialization</span>
<span class="sd">            dbs_depolarization (float, optional):</span>
<span class="sd">                Depolarization effect of the DBS pulse to local soma. Default: None,</span>
<span class="sd">                i.e., use value from initialization</span>
<span class="sd">            orthodromic (bool, optional):</span>
<span class="sd">                If True, DBS causes axonal spikes which are forwarded orthodromically.</span>
<span class="sd">                Default: None, i.e., use value from initialization</span>
<span class="sd">            antidromic (bool, optional):</span>
<span class="sd">                If True, DBS causes axonal spikes which are forwarded antidromically,</span>
<span class="sd">                only available in spiking networks. Default: None, i.e., use value from</span>
<span class="sd">                initialization</span>
<span class="sd">            efferents (bool, optional):</span>
<span class="sd">                If True, DBS affects the efferents of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too). Default: None,</span>
<span class="sd">                i.e., use value from initialization</span>
<span class="sd">            afferents (bool, optional):</span>
<span class="sd">                If True, DBS affects the afferents of the stimulated population</span>
<span class="sd">                (orthodromic and/or antidromic have to be True too). Default: None,</span>
<span class="sd">                i.e., use value from initialization</span>
<span class="sd">            passing_fibres (bool, optional):</span>
<span class="sd">                If True, DBS affects the passing fibres of the stimulated region defined</span>
<span class="sd">                in passing_fibres_list (orthodromic and/or antidromic have to be True</span>
<span class="sd">                too). Default: None, i.e., use value from initialization</span>
<span class="sd">            passing_fibres_strength (float | list[float], optional):</span>
<span class="sd">                Single value or list of float values between 0 and 1 defining how strong</span>
<span class="sd">                the passing fibres are activated by DBS (0: not activated, 1: fully</span>
<span class="sd">                activated like the projections in the DBS stimulated region).</span>
<span class="sd">                Default: None, i.e., use value from initialization</span>
<span class="sd">            sum_branches (bool, optional):</span>
<span class="sd">                If True, the antidromic_prob of a presynaptic population (defining how</span>
<span class="sd">                many axon spikes affect the pop antidromically) of passing fibres is</span>
<span class="sd">                the sum of the passing_fibres_strengths of the single axon branches.</span>
<span class="sd">                Default: None, i.e., use value from initialization</span>
<span class="sd">            axon_spikes_per_pulse (float, optional):</span>
<span class="sd">                Number of average axon spikes per DBS pulse. Default: None, i.e., use</span>
<span class="sd">                value from initialization</span>
<span class="sd">            axon_rate_amp (float | dict[Population | str, float], optional):</span>
<span class="sd">                Similar to prob_axon_spike in spiking model. Which rate is forwarded on</span>
<span class="sd">                axons caused by DBS. You can specify this for each population</span>
<span class="sd">                individually by using a dictionary (keys = Population instances)</span>
<span class="sd">                axon_rate_amp = {pop: 1.5} --&gt; the efferent axons of pop forward a rate</span>
<span class="sd">                of 1.5 during DBS (all other affected projections forward the default</span>
<span class="sd">                value). You can specify the default value by using the key &quot;default&quot;,</span>
<span class="sd">                e.g. {pop: 1.5, &quot;default&quot;: 1.0} -&gt; efferent axons of all populations</span>
<span class="sd">                except pop forward a rate of 1.0 during DBS. Default: None, i.e., use</span>
<span class="sd">                value from initialization</span>
<span class="sd">            seed (int, optional):</span>
<span class="sd">                Seed for the random number generator. Default: None, i.e., use value</span>
<span class="sd">                from initialization</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">### set DBS on for all populations</span>
        <span class="c1">### also sets the proportion of affected neurons, call this before set_depolarization and set_axon_spikes!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_dbs_on</span><span class="p">(</span><span class="n">population_proportion</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>

        <span class="c1">### set depolarization of population</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_depolarization</span><span class="p">(</span><span class="n">dbs_depolarization</span><span class="p">)</span>

        <span class="c1">### set axon spikes forwarding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_axon_spikes</span><span class="p">(</span>
            <span class="n">orthodromic</span><span class="p">,</span>
            <span class="n">antidromic</span><span class="p">,</span>
            <span class="n">efferents</span><span class="p">,</span>
            <span class="n">afferents</span><span class="p">,</span>
            <span class="n">passing_fibres</span><span class="p">,</span>
            <span class="n">passing_fibres_strength</span><span class="p">,</span>
            <span class="n">sum_branches</span><span class="p">,</span>
            <span class="n">axon_spikes_per_pulse</span><span class="p">,</span>
            <span class="n">axon_rate_amp</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_dbs_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population_proportion</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set DBS on for all populations, for the stimulated population only the specified</span>
<span class="sd">        proportion is affected by DBS.</span>

<span class="sd">        Args:</span>
<span class="sd">            population_proportion (float, optional):</span>
<span class="sd">                Proportion of the stimulated population which is affected by DBS,</span>
<span class="sd">                neurons are distributed randomly. Default: None, i.e., use value from</span>
<span class="sd">                initialization</span>
<span class="sd">            seed (int, optional):</span>
<span class="sd">                Seed for the random number generator. Default: None, i.e., use value</span>
<span class="sd">                from initialization</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">### set parameters for the creation of the DBS on array</span>
        <span class="c1">### either use given population_proportion or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">population_proportion</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">population_proportion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">population_proportion</span>
        <span class="c1">### either use given seed or use default value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span>

        <span class="c1">### if seed and population_propotion are the same as in the initialization, use the same dbs_on_array</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="ow">and</span> <span class="n">population_proportion</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">population_proportion</span><span class="p">:</span>
            <span class="c1">### use the same dbs_on_array as in the initialization</span>
            <span class="n">dbs_on_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbs_on_array</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">### create new dbs_on_array</span>
            <span class="n">dbs_on_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dbs_on_array</span><span class="p">(</span><span class="n">population_proportion</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>

        <span class="c1">### set DBS on for all populations</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">populations</span><span class="p">():</span>
            <span class="c1">### of the stimulated population only the specified proportion is affected by DBS</span>
            <span class="k">if</span> <span class="n">pop</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">stimulated_population</span><span class="p">:</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">dbs_on</span> <span class="o">=</span> <span class="n">dbs_on_array</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">dbs_on</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">off</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deactivate DBS.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">### set DBS off for all populations</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">populations</span><span class="p">():</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">dbs_on</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">prob_axon_spike</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1">### deactivate DBS axon transmission</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_deactivate_axon_DBS</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update_pointers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pointer_list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update pointers to populations and projections after recreating the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            pointer_list (list):</span>
<span class="sd">                List of pointers to populations and projections</span>

<span class="sd">        Returns:</span>
<span class="sd">            pointer_list_new (list):</span>
<span class="sd">                List of pointers to populations and projections of the new model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">### update pointers</span>
        <span class="n">pointer_list_new</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Population</span> <span class="o">|</span> <span class="n">Projection</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pointer</span> <span class="ow">in</span> <span class="n">pointer_list</span><span class="p">:</span>
            <span class="n">compartment_name</span> <span class="o">=</span> <span class="n">pointer</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pointer</span><span class="p">,</span> <span class="n">Population</span><span class="p">):</span>
                <span class="n">pointer_list_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_population</span><span class="p">(</span><span class="n">compartment_name</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pointer</span><span class="p">,</span> <span class="n">Projection</span><span class="p">):</span>
                <span class="n">pointer_list_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_projection</span><span class="p">(</span><span class="n">compartment_name</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Pointer </span><span class="si">{</span><span class="n">pointer</span><span class="si">}</span><span class="s2"> is neither a Population nor a Projection&quot;</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">pointer_list_new</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="CompNeuroPy.dbs.DBSstimulator.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">stimulated_population</span><span class="p">,</span> <span class="n">population_proportion</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">excluded_populations_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">dbs_depolarization</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">orthodromic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">antidromic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">efferents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">afferents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">passing_fibres</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">passing_fibres_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">passing_fibres_strength</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sum_branches</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dbs_pulse_frequency_Hz</span><span class="o">=</span><span class="mf">130.0</span><span class="p">,</span> <span class="n">dbs_pulse_width_us</span><span class="o">=</span><span class="mf">300.0</span><span class="p">,</span> <span class="n">axon_spikes_per_pulse</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">axon_rate_amp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auto_implement</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#CompNeuroPy.dbs.DBSstimulator.__init__" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize DBS stimulator.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do this before compiling the model!</p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stimulated_population</code></td>
          <td>
                <code><span title="ANNarchy.Population">Population</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Population which is stimulated by DBS</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>population_proportion</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Proportion of the stimulated population which is affected by DBS,
neurons are distributed randomly. Default: 1.0.</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>excluded_populations_list</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of populations which are excluded from DBS effects, they are not
affected and their axons do not generate axon spikes. Default: [].</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>dbs_depolarization</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Depolarization effect of the DBS pulse to local soma. Default: 0.0.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>orthodromic</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, DBS causes axonal spikes which are forwarded orthodromically.
Default: False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>antidromic</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, DBS causes axonal spikes which are forwarded antidromically,
only available in spiking networks. Default: False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>efferents</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, DBS affects the efferents of the stimulated population
(orthodromic and/or antidromic have to be True too). Default: False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>afferents</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, DBS affects the afferents of the stimulated population
(orthodromic and/or antidromic have to be True too). Default: False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>passing_fibres</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, DBS affects the passing fibres of the stimulated region defined
in passing_fibres_list (orthodromic and/or antidromic have to be True
too). Default: False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>passing_fibres_list</code></td>
          <td>
                <code>list of Projections</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of projections which pass the DBS stimulated region and therefore
are activated by DBS. Default: [], also set passing_fibres True!</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>passing_fibres_strength</code></td>
          <td>
                <code>float or list of float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Single value or list of float values between 0 and 1 defining how strong
the passing fibres are activated by DBS (0: not activated, 1: fully
activated like the projections in the DBS stimulated region).
Default: 1.</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>sum_branches</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, the antidromic_prob of a presynaptic population (defining how
many axon spikes affect the pop antidromically) of passing fibres is
the sum of the passing_fibres_strengths of the single axon branches.
Default: True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>dbs_pulse_frequency_Hz</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Frequency of the DBS pulse. Default: 130 Hz.</p>
            </div>
          </td>
          <td>
                <code>130.0</code>
          </td>
        </tr>
        <tr>
          <td><code>dbs_pulse_width_us</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Width of the DBS pulse. Default: 300 us.</p>
            </div>
          </td>
          <td>
                <code>300.0</code>
          </td>
        </tr>
        <tr>
          <td><code>axon_spikes_per_pulse</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of average axon spikes per DBS pulse. Default: 1.</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>axon_rate_amp</code></td>
          <td>
                <code>float or dict of float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Similar to prob_axon_spike in spiking model. Which rate is forwarded on
axons caused by DBS. You can specify this for each population
individually by using a dictionary (keys = Population instances)
axon_rate_amp = {pop: 1.5} --&gt; the efferent axons of pop forward a rate
of 1.5 during DBS (all other affected projections forward the default
value)
You can specify the default value by using the key "default", e.g.
{pop: 1.5, "default": 1.0} -&gt; efferent axons of all populations except
pop forward a rate of 1.0 during DBS. Default: 1.0.</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Seed for the random distribution of affected neurons based on
population_proportion. Default: None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>auto_implement</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, automatically implement DBS mechanisms to the model. Only
supported for Izhikevich spiking models and rate-coded models.
Default: False.
TODO test what happens with mixed models</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="CompNeuroPy.generate_model.generate_model">generate_model</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>CompNeuroPy model which is used to automatically implement DBS
mechanisms, should not be compiled!. Default: None, i.e., use all
populations and projections of the current magic model</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/dbs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@check_types</span><span class="p">()</span>
<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">stimulated_population</span><span class="p">:</span> <span class="n">Population</span><span class="p">,</span>
    <span class="n">population_proportion</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">excluded_populations_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Population</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">dbs_depolarization</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">orthodromic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">antidromic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">efferents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">afferents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">passing_fibres</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">passing_fibres_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Projection</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">passing_fibres_strength</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">sum_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">dbs_pulse_frequency_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">130.0</span><span class="p">,</span>
    <span class="n">dbs_pulse_width_us</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">300.0</span><span class="p">,</span>
    <span class="n">axon_spikes_per_pulse</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">axon_rate_amp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Population</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">auto_implement</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">generate_model</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize DBS stimulator.</span>

<span class="sd">    !!! warning</span>
<span class="sd">        Do this before compiling the model!</span>

<span class="sd">    Args:</span>
<span class="sd">        stimulated_population (Population):</span>
<span class="sd">            Population which is stimulated by DBS</span>
<span class="sd">        population_proportion (float, optional):</span>
<span class="sd">            Proportion of the stimulated population which is affected by DBS,</span>
<span class="sd">            neurons are distributed randomly. Default: 1.0.</span>
<span class="sd">        excluded_populations_list (list, optional):</span>
<span class="sd">            List of populations which are excluded from DBS effects, they are not</span>
<span class="sd">            affected and their axons do not generate axon spikes. Default: [].</span>
<span class="sd">        dbs_depolarization (float, optional):</span>
<span class="sd">            Depolarization effect of the DBS pulse to local soma. Default: 0.0.</span>
<span class="sd">        orthodromic (bool, optional):</span>
<span class="sd">            If True, DBS causes axonal spikes which are forwarded orthodromically.</span>
<span class="sd">            Default: False.</span>
<span class="sd">        antidromic (bool, optional):</span>
<span class="sd">            If True, DBS causes axonal spikes which are forwarded antidromically,</span>
<span class="sd">            only available in spiking networks. Default: False.</span>
<span class="sd">        efferents (bool, optional):</span>
<span class="sd">            If True, DBS affects the efferents of the stimulated population</span>
<span class="sd">            (orthodromic and/or antidromic have to be True too). Default: False.</span>
<span class="sd">        afferents (bool, optional):</span>
<span class="sd">            If True, DBS affects the afferents of the stimulated population</span>
<span class="sd">            (orthodromic and/or antidromic have to be True too). Default: False.</span>
<span class="sd">        passing_fibres (bool, optional):</span>
<span class="sd">            If True, DBS affects the passing fibres of the stimulated region defined</span>
<span class="sd">            in passing_fibres_list (orthodromic and/or antidromic have to be True</span>
<span class="sd">            too). Default: False.</span>
<span class="sd">        passing_fibres_list (list of Projections, optional):</span>
<span class="sd">            List of projections which pass the DBS stimulated region and therefore</span>
<span class="sd">            are activated by DBS. Default: [], also set passing_fibres True!</span>
<span class="sd">        passing_fibres_strength (float or list of float, optional):</span>
<span class="sd">            Single value or list of float values between 0 and 1 defining how strong</span>
<span class="sd">            the passing fibres are activated by DBS (0: not activated, 1: fully</span>
<span class="sd">            activated like the projections in the DBS stimulated region).</span>
<span class="sd">            Default: 1.</span>
<span class="sd">        sum_branches (bool, optional):</span>
<span class="sd">            If True, the antidromic_prob of a presynaptic population (defining how</span>
<span class="sd">            many axon spikes affect the pop antidromically) of passing fibres is</span>
<span class="sd">            the sum of the passing_fibres_strengths of the single axon branches.</span>
<span class="sd">            Default: True.</span>
<span class="sd">        dbs_pulse_frequency_Hz (float, optional):</span>
<span class="sd">            Frequency of the DBS pulse. Default: 130 Hz.</span>
<span class="sd">        dbs_pulse_width_us (float, optional):</span>
<span class="sd">            Width of the DBS pulse. Default: 300 us.</span>
<span class="sd">        axon_spikes_per_pulse (float, optional):</span>
<span class="sd">            Number of average axon spikes per DBS pulse. Default: 1.</span>
<span class="sd">        axon_rate_amp (float or dict of float, optional):</span>
<span class="sd">            Similar to prob_axon_spike in spiking model. Which rate is forwarded on</span>
<span class="sd">            axons caused by DBS. You can specify this for each population</span>
<span class="sd">            individually by using a dictionary (keys = Population instances)</span>
<span class="sd">            axon_rate_amp = {pop: 1.5} --&gt; the efferent axons of pop forward a rate</span>
<span class="sd">            of 1.5 during DBS (all other affected projections forward the default</span>
<span class="sd">            value)</span>
<span class="sd">            You can specify the default value by using the key &quot;default&quot;, e.g.</span>
<span class="sd">            {pop: 1.5, &quot;default&quot;: 1.0} -&gt; efferent axons of all populations except</span>
<span class="sd">            pop forward a rate of 1.0 during DBS. Default: 1.0.</span>
<span class="sd">        seed (int, optional):</span>
<span class="sd">            Seed for the random distribution of affected neurons based on</span>
<span class="sd">            population_proportion. Default: None.</span>
<span class="sd">        auto_implement (bool, optional):</span>
<span class="sd">            If True, automatically implement DBS mechanisms to the model. Only</span>
<span class="sd">            supported for Izhikevich spiking models and rate-coded models.</span>
<span class="sd">            Default: False.</span>
<span class="sd">            TODO test what happens with mixed models</span>
<span class="sd">        model (generate_model, optional):</span>
<span class="sd">            CompNeuroPy model which is used to automatically implement DBS</span>
<span class="sd">            mechanisms, should not be compiled!. Default: None, i.e., use all</span>
<span class="sd">            populations and projections of the current magic model</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">auto_implement</span><span class="p">:</span>
        <span class="c1">### recreate model with DBS mechanisms</span>
        <span class="c1">### give all variables containing Populations and Projections</span>
        <span class="c1">### and also recreate them during recreating the model</span>
        <span class="c1">### variables are:</span>
        <span class="c1">### - stimulated_population</span>
        <span class="c1">### - excluded_populations_list</span>
        <span class="c1">### - passing_fibres_list</span>
        <span class="c1">### - axon_rate_amp</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="c1">### CompNeuroPy model given</span>
            <span class="c1">### recreate model with DBS mechanisms</span>
            <span class="n">create_dbs_model_obj</span> <span class="o">=</span> <span class="n">_CreateDBSmodelcnp</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="n">stimulated_population</span><span class="p">,</span>
                <span class="n">excluded_populations_list</span><span class="p">,</span>
                <span class="n">passing_fibres_list</span><span class="p">,</span>
                <span class="n">axon_rate_amp</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1">### get the new CompNeuroPy model</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">create_dbs_model_obj</span><span class="o">.</span><span class="n">model</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">### no CompNeuroPy model given --&gt; use all populations and projections of the current magic model</span>
            <span class="c1">### recreate model with DBS mechanisms</span>
            <span class="n">create_dbs_model_obj</span> <span class="o">=</span> <span class="n">_CreateDBSmodel</span><span class="p">(</span>
                <span class="n">stimulated_population</span><span class="p">,</span>
                <span class="n">excluded_populations_list</span><span class="p">,</span>
                <span class="n">passing_fibres_list</span><span class="p">,</span>
                <span class="n">axon_rate_amp</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="c1">### get the new variables containing Populations and Projections</span>
        <span class="n">stimulated_population</span> <span class="o">=</span> <span class="n">create_dbs_model_obj</span><span class="o">.</span><span class="n">stimulated_population</span>
        <span class="n">excluded_populations_list</span> <span class="o">=</span> <span class="n">create_dbs_model_obj</span><span class="o">.</span><span class="n">excluded_populations_list</span>
        <span class="n">passing_fibres_list</span> <span class="o">=</span> <span class="n">create_dbs_model_obj</span><span class="o">.</span><span class="n">passing_fibres_list</span>
        <span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="n">create_dbs_model_obj</span><span class="o">.</span><span class="n">axon_rate_amp</span>

    <span class="c1">### set parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stimulated_population</span> <span class="o">=</span> <span class="n">stimulated_population</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">population_proportion</span> <span class="o">=</span> <span class="n">population_proportion</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">excluded_populations_list</span> <span class="o">=</span> <span class="n">excluded_populations_list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dbs_depolarization</span> <span class="o">=</span> <span class="n">dbs_depolarization</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">orthodromic</span> <span class="o">=</span> <span class="n">orthodromic</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">antidromic</span> <span class="o">=</span> <span class="n">antidromic</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">efferents</span> <span class="o">=</span> <span class="n">efferents</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">afferents</span> <span class="o">=</span> <span class="n">afferents</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres</span> <span class="o">=</span> <span class="n">passing_fibres</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres_list</span> <span class="o">=</span> <span class="n">passing_fibres_list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">passing_fibres_strength</span> <span class="o">=</span> <span class="n">passing_fibres_strength</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sum_branches</span> <span class="o">=</span> <span class="n">sum_branches</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dbs_pulse_width_us</span> <span class="o">=</span> <span class="n">dbs_pulse_width_us</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">axon_spikes_per_pulse</span> <span class="o">=</span> <span class="n">axon_spikes_per_pulse</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="n">axon_rate_amp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

    <span class="c1">### ANNarchy constants for DBS</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_set_constants</span><span class="p">(</span><span class="n">dbs_pulse_frequency_Hz</span><span class="p">)</span>

    <span class="c1">### randomly select affected neurons i.e. create dbs_on_array</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dbs_on_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dbs_on_array</span><span class="p">(</span><span class="n">population_proportion</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="CompNeuroPy.dbs.DBSstimulator.on" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on</span><span class="p">(</span><span class="n">population_proportion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dbs_depolarization</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orthodromic</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">antidromic</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">efferents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">afferents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">passing_fibres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">passing_fibres_strength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sum_branches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axon_spikes_per_pulse</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axon_rate_amp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#CompNeuroPy.dbs.DBSstimulator.on" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Activate DBS.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>population_proportion</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Proportion of the stimulated population which is affected by DBS,
neurons are distributed randomly. Default: None, i.e., use value from
initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dbs_depolarization</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Depolarization effect of the DBS pulse to local soma. Default: None,
i.e., use value from initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>orthodromic</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, DBS causes axonal spikes which are forwarded orthodromically.
Default: None, i.e., use value from initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>antidromic</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, DBS causes axonal spikes which are forwarded antidromically,
only available in spiking networks. Default: None, i.e., use value from
initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>efferents</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, DBS affects the efferents of the stimulated population
(orthodromic and/or antidromic have to be True too). Default: None,
i.e., use value from initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>afferents</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, DBS affects the afferents of the stimulated population
(orthodromic and/or antidromic have to be True too). Default: None,
i.e., use value from initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>passing_fibres</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, DBS affects the passing fibres of the stimulated region defined
in passing_fibres_list (orthodromic and/or antidromic have to be True
too). Default: None, i.e., use value from initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>passing_fibres_strength</code></td>
          <td>
                <code>float | list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Single value or list of float values between 0 and 1 defining how strong
the passing fibres are activated by DBS (0: not activated, 1: fully
activated like the projections in the DBS stimulated region).
Default: None, i.e., use value from initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>sum_branches</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, the antidromic_prob of a presynaptic population (defining how
many axon spikes affect the pop antidromically) of passing fibres is
the sum of the passing_fibres_strengths of the single axon branches.
Default: None, i.e., use value from initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>axon_spikes_per_pulse</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of average axon spikes per DBS pulse. Default: None, i.e., use
value from initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>axon_rate_amp</code></td>
          <td>
                <code>float | dict[<span title="ANNarchy.Population">Population</span> | str, float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Similar to prob_axon_spike in spiking model. Which rate is forwarded on
axons caused by DBS. You can specify this for each population
individually by using a dictionary (keys = Population instances)
axon_rate_amp = {pop: 1.5} --&gt; the efferent axons of pop forward a rate
of 1.5 during DBS (all other affected projections forward the default
value). You can specify the default value by using the key "default",
e.g. {pop: 1.5, "default": 1.0} -&gt; efferent axons of all populations
except pop forward a rate of 1.0 during DBS. Default: None, i.e., use
value from initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Seed for the random number generator. Default: None, i.e., use value
from initialization</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/dbs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@check_types</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">on</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">population_proportion</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dbs_depolarization</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">orthodromic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">antidromic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">efferents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">afferents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">passing_fibres</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">passing_fibres_strength</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sum_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">axon_spikes_per_pulse</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">axon_rate_amp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Population</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Activate DBS.</span>

<span class="sd">    Args:</span>
<span class="sd">        population_proportion (float, optional):</span>
<span class="sd">            Proportion of the stimulated population which is affected by DBS,</span>
<span class="sd">            neurons are distributed randomly. Default: None, i.e., use value from</span>
<span class="sd">            initialization</span>
<span class="sd">        dbs_depolarization (float, optional):</span>
<span class="sd">            Depolarization effect of the DBS pulse to local soma. Default: None,</span>
<span class="sd">            i.e., use value from initialization</span>
<span class="sd">        orthodromic (bool, optional):</span>
<span class="sd">            If True, DBS causes axonal spikes which are forwarded orthodromically.</span>
<span class="sd">            Default: None, i.e., use value from initialization</span>
<span class="sd">        antidromic (bool, optional):</span>
<span class="sd">            If True, DBS causes axonal spikes which are forwarded antidromically,</span>
<span class="sd">            only available in spiking networks. Default: None, i.e., use value from</span>
<span class="sd">            initialization</span>
<span class="sd">        efferents (bool, optional):</span>
<span class="sd">            If True, DBS affects the efferents of the stimulated population</span>
<span class="sd">            (orthodromic and/or antidromic have to be True too). Default: None,</span>
<span class="sd">            i.e., use value from initialization</span>
<span class="sd">        afferents (bool, optional):</span>
<span class="sd">            If True, DBS affects the afferents of the stimulated population</span>
<span class="sd">            (orthodromic and/or antidromic have to be True too). Default: None,</span>
<span class="sd">            i.e., use value from initialization</span>
<span class="sd">        passing_fibres (bool, optional):</span>
<span class="sd">            If True, DBS affects the passing fibres of the stimulated region defined</span>
<span class="sd">            in passing_fibres_list (orthodromic and/or antidromic have to be True</span>
<span class="sd">            too). Default: None, i.e., use value from initialization</span>
<span class="sd">        passing_fibres_strength (float | list[float], optional):</span>
<span class="sd">            Single value or list of float values between 0 and 1 defining how strong</span>
<span class="sd">            the passing fibres are activated by DBS (0: not activated, 1: fully</span>
<span class="sd">            activated like the projections in the DBS stimulated region).</span>
<span class="sd">            Default: None, i.e., use value from initialization</span>
<span class="sd">        sum_branches (bool, optional):</span>
<span class="sd">            If True, the antidromic_prob of a presynaptic population (defining how</span>
<span class="sd">            many axon spikes affect the pop antidromically) of passing fibres is</span>
<span class="sd">            the sum of the passing_fibres_strengths of the single axon branches.</span>
<span class="sd">            Default: None, i.e., use value from initialization</span>
<span class="sd">        axon_spikes_per_pulse (float, optional):</span>
<span class="sd">            Number of average axon spikes per DBS pulse. Default: None, i.e., use</span>
<span class="sd">            value from initialization</span>
<span class="sd">        axon_rate_amp (float | dict[Population | str, float], optional):</span>
<span class="sd">            Similar to prob_axon_spike in spiking model. Which rate is forwarded on</span>
<span class="sd">            axons caused by DBS. You can specify this for each population</span>
<span class="sd">            individually by using a dictionary (keys = Population instances)</span>
<span class="sd">            axon_rate_amp = {pop: 1.5} --&gt; the efferent axons of pop forward a rate</span>
<span class="sd">            of 1.5 during DBS (all other affected projections forward the default</span>
<span class="sd">            value). You can specify the default value by using the key &quot;default&quot;,</span>
<span class="sd">            e.g. {pop: 1.5, &quot;default&quot;: 1.0} -&gt; efferent axons of all populations</span>
<span class="sd">            except pop forward a rate of 1.0 during DBS. Default: None, i.e., use</span>
<span class="sd">            value from initialization</span>
<span class="sd">        seed (int, optional):</span>
<span class="sd">            Seed for the random number generator. Default: None, i.e., use value</span>
<span class="sd">            from initialization</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### set DBS on for all populations</span>
    <span class="c1">### also sets the proportion of affected neurons, call this before set_depolarization and set_axon_spikes!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_set_dbs_on</span><span class="p">(</span><span class="n">population_proportion</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>

    <span class="c1">### set depolarization of population</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_set_depolarization</span><span class="p">(</span><span class="n">dbs_depolarization</span><span class="p">)</span>

    <span class="c1">### set axon spikes forwarding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_set_axon_spikes</span><span class="p">(</span>
        <span class="n">orthodromic</span><span class="p">,</span>
        <span class="n">antidromic</span><span class="p">,</span>
        <span class="n">efferents</span><span class="p">,</span>
        <span class="n">afferents</span><span class="p">,</span>
        <span class="n">passing_fibres</span><span class="p">,</span>
        <span class="n">passing_fibres_strength</span><span class="p">,</span>
        <span class="n">sum_branches</span><span class="p">,</span>
        <span class="n">axon_spikes_per_pulse</span><span class="p">,</span>
        <span class="n">axon_rate_amp</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="CompNeuroPy.dbs.DBSstimulator.off" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">off</span><span class="p">()</span></code>

<a href="#CompNeuroPy.dbs.DBSstimulator.off" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Deactivate DBS.</p>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/dbs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">off</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deactivate DBS.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">### set DBS off for all populations</span>
    <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">populations</span><span class="p">():</span>
        <span class="n">pop</span><span class="o">.</span><span class="n">dbs_on</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">pop</span><span class="o">.</span><span class="n">prob_axon_spike</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">pop</span><span class="o">.</span><span class="n">axon_rate_amp</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">### deactivate DBS axon transmission</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_deactivate_axon_DBS</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="CompNeuroPy.dbs.DBSstimulator.update_pointers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update_pointers</span><span class="p">(</span><span class="n">pointer_list</span><span class="p">)</span></code>

<a href="#CompNeuroPy.dbs.DBSstimulator.update_pointers" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Update pointers to populations and projections after recreating the model.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pointer_list</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of pointers to populations and projections</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>pointer_list_new</code></td>          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of pointers to populations and projections of the new model</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/dbs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_pointers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pointer_list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update pointers to populations and projections after recreating the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        pointer_list (list):</span>
<span class="sd">            List of pointers to populations and projections</span>

<span class="sd">    Returns:</span>
<span class="sd">        pointer_list_new (list):</span>
<span class="sd">            List of pointers to populations and projections of the new model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">### update pointers</span>
    <span class="n">pointer_list_new</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Population</span> <span class="o">|</span> <span class="n">Projection</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pointer</span> <span class="ow">in</span> <span class="n">pointer_list</span><span class="p">:</span>
        <span class="n">compartment_name</span> <span class="o">=</span> <span class="n">pointer</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pointer</span><span class="p">,</span> <span class="n">Population</span><span class="p">):</span>
            <span class="n">pointer_list_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_population</span><span class="p">(</span><span class="n">compartment_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pointer</span><span class="p">,</span> <span class="n">Projection</span><span class="p">):</span>
            <span class="n">pointer_list_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_projection</span><span class="p">(</span><span class="n">compartment_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Pointer </span><span class="si">{</span><span class="n">pointer</span><span class="si">}</span><span class="s2"> is neither a Population nor a Projection&quot;</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">pointer_list_new</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Oliver Maith
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.cd18aaf1.min.js"></script>
      
    
  </body>
</html>