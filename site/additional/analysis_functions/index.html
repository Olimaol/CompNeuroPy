
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../simulation_functions/">
      
      
        <link rel="next" href="../model_functions/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.14">
    
    
      
        <title>Analysis Functions - CompNeuroPy</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#src.CompNeuroPy.analysis_functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CompNeuroPy" class="md-header__button md-logo" aria-label="CompNeuroPy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CompNeuroPy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Analysis Functions
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Olimaol/CompNeuroPy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CompNeuroPy" class="md-nav__button md-logo" aria-label="CompNeuroPy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    CompNeuroPy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Olimaol/CompNeuroPy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Main Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Main Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/generate_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/generate_simulations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Simulations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/monitors_recordings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitors / Recordings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/optimize_neuron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimize a neuron model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/define_experiment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Define an Experiment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/dbs_stimulator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DBS Stimulator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/model_configurator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Configurator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Built-in Objects
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Built-in Objects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../built_in/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../built_in/neuron_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neuron Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../built_in/synapse_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Synapse Models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Additional Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Additional Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulation_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulation Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Analysis Functions
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Analysis Functions
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions" class="md-nav__link">
    <span class="md-ellipsis">
      analysis_functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.my_raster_plot" class="md-nav__link">
    <span class="md-ellipsis">
      my_raster_plot()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_nanmean" class="md-nav__link">
    <span class="md-ellipsis">
      get_nanmean()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_nanstd" class="md-nav__link">
    <span class="md-ellipsis">
      get_nanstd()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_population_power_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      get_population_power_spectrum()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_power_spektrum_from_time_array" class="md-nav__link">
    <span class="md-ellipsis">
      get_power_spektrum_from_time_array()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_pop_rate" class="md-nav__link">
    <span class="md-ellipsis">
      get_pop_rate()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.plot_recordings" class="md-nav__link">
    <span class="md-ellipsis">
      plot_recordings()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_number_of_zero_decimals" class="md-nav__link">
    <span class="md-ellipsis">
      get_number_of_zero_decimals()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_number_of_decimals" class="md-nav__link">
    <span class="md-ellipsis">
      get_number_of_decimals()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.sample_data_with_timestep" class="md-nav__link">
    <span class="md-ellipsis">
      sample_data_with_timestep()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.time_data_add_nan" class="md-nav__link">
    <span class="md-ellipsis">
      time_data_add_nan()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.rmse" class="md-nav__link">
    <span class="md-ellipsis">
      rmse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.rsse" class="md-nav__link">
    <span class="md-ellipsis">
      rsse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_minimum" class="md-nav__link">
    <span class="md-ellipsis">
      get_minimum()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_maximum" class="md-nav__link">
    <span class="md-ellipsis">
      get_maximum()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../system_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extra_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extra Functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/generate_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions" class="md-nav__link">
    <span class="md-ellipsis">
      analysis_functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.my_raster_plot" class="md-nav__link">
    <span class="md-ellipsis">
      my_raster_plot()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_nanmean" class="md-nav__link">
    <span class="md-ellipsis">
      get_nanmean()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_nanstd" class="md-nav__link">
    <span class="md-ellipsis">
      get_nanstd()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_population_power_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      get_population_power_spectrum()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_power_spektrum_from_time_array" class="md-nav__link">
    <span class="md-ellipsis">
      get_power_spektrum_from_time_array()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_pop_rate" class="md-nav__link">
    <span class="md-ellipsis">
      get_pop_rate()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.plot_recordings" class="md-nav__link">
    <span class="md-ellipsis">
      plot_recordings()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_number_of_zero_decimals" class="md-nav__link">
    <span class="md-ellipsis">
      get_number_of_zero_decimals()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_number_of_decimals" class="md-nav__link">
    <span class="md-ellipsis">
      get_number_of_decimals()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.sample_data_with_timestep" class="md-nav__link">
    <span class="md-ellipsis">
      sample_data_with_timestep()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.time_data_add_nan" class="md-nav__link">
    <span class="md-ellipsis">
      time_data_add_nan()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.rmse" class="md-nav__link">
    <span class="md-ellipsis">
      rmse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.rsse" class="md-nav__link">
    <span class="md-ellipsis">
      rsse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_minimum" class="md-nav__link">
    <span class="md-ellipsis">
      get_minimum()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.CompNeuroPy.analysis_functions.get_maximum" class="md-nav__link">
    <span class="md-ellipsis">
      get_maximum()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Analysis Functions</h1>

<div class="doc doc-object doc-module">



<a id="src.CompNeuroPy.analysis_functions"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.my_raster_plot" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">my_raster_plot</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.my_raster_plot" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns two vectors representing for each recorded spike 1) the spike times and 2)
the ranks of the neurons. The spike times are always in simulation steps (in
contrast to default ANNarchy raster_plot).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>spikes</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ANNarchy spike dict of one population</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>t</code></td>          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>spike times in simulation steps</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>n</code></td>          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ranks of the neurons</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">my_raster_plot</span><span class="p">(</span><span class="n">spikes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns two vectors representing for each recorded spike 1) the spike times and 2)</span>
<span class="sd">    the ranks of the neurons. The spike times are always in simulation steps (in</span>
<span class="sd">    contrast to default ANNarchy raster_plot).</span>

<span class="sd">    Args:</span>
<span class="sd">        spikes (dict):</span>
<span class="sd">            ANNarchy spike dict of one population</span>

<span class="sd">    Returns:</span>
<span class="sd">        t (array):</span>
<span class="sd">            spike times in simulation steps</span>
<span class="sd">        n (array):</span>
<span class="sd">            ranks of the neurons</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">raster_plot</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">dt</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">n</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.get_nanmean" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_nanmean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.get_nanmean" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Same as np.nanmean but without printing warnings.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>a</code></td>
          <td>
                <code>array_like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array containing numbers whose mean is desired. If <code>a</code> is not an
array, a conversion is attempted.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>axis</code></td>
          <td>
                <code>None or int or tuple of ints</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis or axes along which the means are computed. The default is to
compute the mean of the flattened array.</p>
<p>.. numpy versionadded:: 1.7.0</p>
<p>If this is a tuple of ints, a mean is performed over multiple axes,
instead of a single axis or all the axes as before.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code>data - type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type to use in computing the mean.  For integer inputs, the default
is <code>float64</code>; for floating point inputs, it is the same as the
input dtype.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>m</code></td>          <td>
                <code>ndarray, see dtype parameter above</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>out=None</code>, returns a new array containing the mean values,
otherwise a reference to the output array is returned.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_nanmean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Same as np.nanmean but without printing warnings.</span>

<span class="sd">    Args:</span>
<span class="sd">        a (array_like):</span>
<span class="sd">            Array containing numbers whose mean is desired. If `a` is not an</span>
<span class="sd">            array, a conversion is attempted.</span>
<span class="sd">        axis (None or int or tuple of ints, optional):</span>
<span class="sd">            Axis or axes along which the means are computed. The default is to</span>
<span class="sd">            compute the mean of the flattened array.</span>

<span class="sd">            .. numpy versionadded:: 1.7.0</span>

<span class="sd">            If this is a tuple of ints, a mean is performed over multiple axes,</span>
<span class="sd">            instead of a single axis or all the axes as before.</span>
<span class="sd">        dtype (data-type, optional):</span>
<span class="sd">            Type to use in computing the mean.  For integer inputs, the default</span>
<span class="sd">            is `float64`; for floating point inputs, it is the same as the</span>
<span class="sd">            input dtype.</span>

<span class="sd">    Returns:</span>
<span class="sd">        m (ndarray, see dtype parameter above):</span>
<span class="sd">            If `out=None`, returns a new array containing the mean values,</span>
<span class="sd">            otherwise a reference to the output array is returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.get_nanstd" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_nanstd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.get_nanstd" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Same as np.nanstd but without printing warnings.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>a</code></td>
          <td>
                <code>array_like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Calculate the standard deviation of these values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>axis</code></td>
          <td>
                <code>None or int or tuple of ints</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis or axes along which the standard deviation is computed. The
default is to compute the standard deviation of the flattened array.</p>
<p>.. numpy versionadded:: 1.7.0</p>
<p>If this is a tuple of ints, a standard deviation is performed over
multiple axes, instead of a single axis or all the axes as before.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code>dtype</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type to use in computing the standard deviation. For arrays of
integer type the default is float64, for arrays of float types it is
the same as the array type.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>standard_deviation</code></td>          <td>
                <code>ndarray, see dtype parameter above</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>out</code> is None, return a new array containing the standard deviation,
otherwise return a reference to the output array.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_nanstd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Same as np.nanstd but without printing warnings.</span>

<span class="sd">    Args:</span>
<span class="sd">        a (array_like):</span>
<span class="sd">            Calculate the standard deviation of these values.</span>
<span class="sd">        axis (None or int or tuple of ints, optional):</span>
<span class="sd">            Axis or axes along which the standard deviation is computed. The</span>
<span class="sd">            default is to compute the standard deviation of the flattened array.</span>

<span class="sd">            .. numpy versionadded:: 1.7.0</span>

<span class="sd">            If this is a tuple of ints, a standard deviation is performed over</span>
<span class="sd">            multiple axes, instead of a single axis or all the axes as before.</span>
<span class="sd">        dtype (dtype, optional):</span>
<span class="sd">            Type to use in computing the standard deviation. For arrays of</span>
<span class="sd">            integer type the default is float64, for arrays of float types it is</span>
<span class="sd">            the same as the array type.</span>

<span class="sd">    Returns:</span>
<span class="sd">        standard_deviation (ndarray, see dtype parameter above):</span>
<span class="sd">            If `out` is None, return a new array containing the standard deviation,</span>
<span class="sd">            otherwise return a reference to the output array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.get_population_power_spectrum" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_population_power_spectrum</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">t_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fft_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.get_population_power_spectrum" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Generates power spectrum of population spikes, returns frequency_arr and
power_spectrum_arr. Using the Welch methode from: Welch, P. (1967). The use of fast
Fourier transform for the estimation of power spectra: a method based on time
averaging over short, modified periodograms. IEEE Transactions on audio and
electroacoustics, 15(2), 70-73.</p>
<p>The spike arrays are splitted into multiple arrays and then multiple FFTs are
performed and the results are averaged.</p>
<p>Size of splitted signals and the time step of the simulation determine the frequency
resolution and the maximum frequency:
    maximum frequency [Hz] = 500 / time_step
    frequency resolution [Hz] = 1000 / (time_step * fftSize)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>spikes</code></td>
          <td>
                <code>dicitonary</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ANNarchy spike dict of one population</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>time_step</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>time step of the simulation in ms</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>t_start</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>start time of analyzed data in ms. Default: time of first spike</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>t_end</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>end time of analyzed data in ms. Default: time of last spike</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fft_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>signal size for the FFT (size of splitted arrays)
has to be a power of 2. Default: maximum</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>frequency_arr</code></td>          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>array with frequencies</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>spectrum</code></td>          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>array with power spectrum</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_population_power_spectrum</span><span class="p">(</span>
    <span class="n">spikes</span><span class="p">,</span>
    <span class="n">time_step</span><span class="p">,</span>
    <span class="n">t_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">t_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fft_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates power spectrum of population spikes, returns frequency_arr and</span>
<span class="sd">    power_spectrum_arr. Using the Welch methode from: Welch, P. (1967). The use of fast</span>
<span class="sd">    Fourier transform for the estimation of power spectra: a method based on time</span>
<span class="sd">    averaging over short, modified periodograms. IEEE Transactions on audio and</span>
<span class="sd">    electroacoustics, 15(2), 70-73.</span>

<span class="sd">    The spike arrays are splitted into multiple arrays and then multiple FFTs are</span>
<span class="sd">    performed and the results are averaged.</span>

<span class="sd">    Size of splitted signals and the time step of the simulation determine the frequency</span>
<span class="sd">    resolution and the maximum frequency:</span>
<span class="sd">        maximum frequency [Hz] = 500 / time_step</span>
<span class="sd">        frequency resolution [Hz] = 1000 / (time_step * fftSize)</span>

<span class="sd">    Args:</span>
<span class="sd">        spikes (dicitonary):</span>
<span class="sd">            ANNarchy spike dict of one population</span>
<span class="sd">        time_step (float):</span>
<span class="sd">            time step of the simulation in ms</span>
<span class="sd">        t_start (float or int, optional):</span>
<span class="sd">            start time of analyzed data in ms. Default: time of first spike</span>
<span class="sd">        t_end (float or int, optional):</span>
<span class="sd">            end time of analyzed data in ms. Default: time of last spike</span>
<span class="sd">        fft_size (int, optional):</span>
<span class="sd">            signal size for the FFT (size of splitted arrays)</span>
<span class="sd">            has to be a power of 2. Default: maximum</span>

<span class="sd">    Returns:</span>
<span class="sd">        frequency_arr (array):</span>
<span class="sd">            array with frequencies</span>
<span class="sd">        spectrum (array):</span>
<span class="sd">            array with power spectrum</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">ms_to_s</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">1000</span>

    <span class="c1">### get population_size / sampling_frequency</span>
    <span class="n">populations_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">spikes</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">sampling_frequency</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">ms_to_s</span><span class="p">(</span><span class="n">time_step</span><span class="p">)</span>  <span class="c1"># in Hz</span>

    <span class="c1">### check if there are spikes in data</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">my_raster_plot</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1">### there are no 2 spikes</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: get_population_power_spectrum: &lt;2 spikes!&quot;</span><span class="p">)</span>
        <span class="c1">### --&gt; return None or zeros</span>
        <span class="k">if</span> <span class="n">fft_size</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;ERROR: get_population_power_spectrum: &lt;2 spikes and no fft_size given!&quot;</span>
            <span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">frequency_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">fft_size</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">sampling_frequency</span><span class="p">)</span>
            <span class="n">frequency_arr_ret</span> <span class="o">=</span> <span class="n">frequency_arr</span><span class="p">[</span><span class="mi">2</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">fft_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span>
            <span class="n">spectrum_ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">frequency_arr_ret</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">frequency_arr_ret</span><span class="p">,</span> <span class="n">spectrum_ret</span><span class="p">]</span>

    <span class="c1">### check if t_start / t_end are None</span>
    <span class="k">if</span> <span class="n">t_start</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t_start</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">*</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">get_number_of_decimals</span><span class="p">(</span><span class="n">time_step</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">t_end</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t_end</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">get_number_of_decimals</span><span class="p">(</span><span class="n">time_step</span><span class="p">))</span>

    <span class="c1">### calculate time</span>
    <span class="n">simulation_time</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">t_end</span> <span class="o">-</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">get_number_of_decimals</span><span class="p">(</span><span class="n">time_step</span><span class="p">))</span>  <span class="c1"># in ms</span>

    <span class="c1">### get fft_size</span>
    <span class="c1">### if None --&gt; as large as possible</span>
    <span class="k">if</span> <span class="n">fft_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">pow</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="nb">pow</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">sampling_frequency</span> <span class="o">&lt;</span> <span class="n">ms_to_s</span><span class="p">(</span><span class="n">simulation_time</span><span class="p">):</span>
            <span class="nb">pow</span> <span class="o">=</span> <span class="nb">pow</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">fft_size</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="nb">pow</span>

    <span class="k">if</span> <span class="n">ms_to_s</span><span class="p">(</span><span class="n">simulation_time</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">fft_size</span> <span class="o">/</span> <span class="n">sampling_frequency</span><span class="p">):</span>
        <span class="c1">### catch a too large fft_size</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Too large fft_size </span><span class="si">{</span><span class="n">fft_size</span><span class="si">}</span><span class="s2"> for duration </span><span class="si">{</span><span class="n">simulation_time</span><span class="si">}</span><span class="s2"> ms. FFT_size has to be smaller than </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">ms_to_s</span><span class="p">(</span><span class="n">simulation_time</span><span class="p">)</span><span class="o">*</span><span class="n">sampling_frequency</span><span class="p">)</span><span class="si">}</span><span class="s2">!&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fft_size</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fft_size</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))]</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">fft_size</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">fft_size</span><span class="p">)))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">### catch fft_size if its not power of 2</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FFT_size hast to be power of 2!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fft_size</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fft_size</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;power sepctrum, min = </span><span class="si">{</span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">time_step</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fft_size</span><span class="p">)</span><span class="si">}</span><span class="s2">, max = </span><span class="si">{</span><span class="mi">500</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">time_step</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="c1">### calculate frequency powers</span>
        <span class="n">spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">populations_size</span><span class="p">,</span> <span class="n">fft_size</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">neuron</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">populations_size</span><span class="p">):</span>
            <span class="c1">### sampling steps array</span>
            <span class="n">spiketrain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ms_to_s</span><span class="p">(</span><span class="n">simulation_time</span><span class="p">)</span> <span class="o">*</span> <span class="n">sampling_frequency</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="c1">### spike times as sampling steps</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
                    <span class="n">ms_to_s</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spikes</span><span class="p">[</span><span class="n">neuron</span><span class="p">])</span> <span class="o">*</span> <span class="n">time_step</span><span class="p">))</span> <span class="o">*</span> <span class="n">sampling_frequency</span>
                <span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
            <span class="c1">### cut the spikes before t_start and after t_end</span>
            <span class="n">idx_start</span> <span class="o">=</span> <span class="n">ms_to_s</span><span class="p">(</span><span class="n">t_start</span><span class="p">)</span> <span class="o">*</span> <span class="n">sampling_frequency</span>
            <span class="n">idx_end</span> <span class="o">=</span> <span class="n">ms_to_s</span><span class="p">(</span><span class="n">t_end</span><span class="p">)</span> <span class="o">*</span> <span class="n">sampling_frequency</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="p">((</span><span class="n">idx</span> <span class="o">&gt;</span> <span class="n">idx_start</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&lt;</span> <span class="n">idx_end</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                <span class="nb">bool</span>
            <span class="p">)</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx_start</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

            <span class="c1">### set spiketrain array to one if there was a spike at sampling step</span>
            <span class="n">spiketrain</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1">### generate multiple overlapping sequences out of the spike trains</span>
            <span class="n">spiketrain_sequences</span> <span class="o">=</span> <span class="n">_hanning_split_overlap</span><span class="p">(</span>
                <span class="n">spiketrain</span><span class="p">,</span> <span class="n">fft_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">fft_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1">### generate power spectrum</span>
            <span class="n">spectrum</span><span class="p">[</span><span class="n">neuron</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_nanmean</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">spiketrain_sequences</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span>
            <span class="p">)</span>

        <span class="c1">### mean spectrum over all neurons</span>
        <span class="n">spectrum</span> <span class="o">=</span> <span class="n">get_nanmean</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">frequency_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">fft_size</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">sampling_frequency</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">frequency_arr</span><span class="p">[</span><span class="mi">2</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">fft_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">spectrum</span><span class="p">[</span><span class="mi">2</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">fft_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.get_power_spektrum_from_time_array" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_power_spektrum_from_time_array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">presimulationTime</span><span class="p">,</span> <span class="n">simulationTime</span><span class="p">,</span> <span class="n">simulation_dt</span><span class="p">,</span> <span class="n">samplingfrequency</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">fftSize</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.get_power_spektrum_from_time_array" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Generates power spectrum of time signal (returns frequencies_arr and power_arr).
Using the Welch methode (Welch,1967).</p>
<p>amplingfrequency: to sample the arr, in Hz --&gt; max frequency = samplingfrequency / 2
fftSize: signal size for FFT, duration (in s) = fftSize / samplingfrequency
--&gt; frequency resolution = samplingfrequency / fftSize</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>arr</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>time array, value for each timestep</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>presimulationTime</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>simulation time which will not be analyzed</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>simulationTime</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>analyzed simulation time</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>simulation_dt</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>simulation timestep</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>samplingfrequency</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>sampling frequency for sampling the time array. Default: 250</p>
            </div>
          </td>
          <td>
                <code>250</code>
          </td>
        </tr>
        <tr>
          <td><code>fftSize</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>signal size for the FFT (size of splitted arrays)
has to be a power of 2. Default: 1024</p>
            </div>
          </td>
          <td>
                <code>1024</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>frequency_arr</code></td>          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>array with frequencies</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>spectrum</code></td>          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>array with power spectrum</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_power_spektrum_from_time_array</span><span class="p">(</span>
    <span class="n">arr</span><span class="p">,</span>
    <span class="n">presimulationTime</span><span class="p">,</span>
    <span class="n">simulationTime</span><span class="p">,</span>
    <span class="n">simulation_dt</span><span class="p">,</span>
    <span class="n">samplingfrequency</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">fftSize</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates power spectrum of time signal (returns frequencies_arr and power_arr).</span>
<span class="sd">    Using the Welch methode (Welch,1967).</span>

<span class="sd">    amplingfrequency: to sample the arr, in Hz --&gt; max frequency = samplingfrequency / 2</span>
<span class="sd">    fftSize: signal size for FFT, duration (in s) = fftSize / samplingfrequency</span>
<span class="sd">    --&gt; frequency resolution = samplingfrequency / fftSize</span>

<span class="sd">    Args:</span>
<span class="sd">        arr (array):</span>
<span class="sd">            time array, value for each timestep</span>
<span class="sd">        presimulationTime (float or int):</span>
<span class="sd">            simulation time which will not be analyzed</span>
<span class="sd">        simulationTime (float or int):</span>
<span class="sd">            analyzed simulation time</span>
<span class="sd">        simulation_dt (float or int):</span>
<span class="sd">            simulation timestep</span>
<span class="sd">        samplingfrequency (float or int, optional):</span>
<span class="sd">            sampling frequency for sampling the time array. Default: 250</span>
<span class="sd">        fftSize (int, optional):</span>
<span class="sd">            signal size for the FFT (size of splitted arrays)</span>
<span class="sd">            has to be a power of 2. Default: 1024</span>

<span class="sd">    Returns:</span>
<span class="sd">        frequency_arr (array):</span>
<span class="sd">            array with frequencies</span>
<span class="sd">        spectrum (array):</span>
<span class="sd">            array with power spectrum</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">simulationTime</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">fftSize</span> <span class="o">/</span> <span class="n">samplingfrequency</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulation time has to be &gt;=&quot;</span><span class="p">,</span> <span class="n">fftSize</span> <span class="o">/</span> <span class="n">samplingfrequency</span><span class="p">,</span> <span class="s2">&quot;s for FFT!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fftSize</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fftSize</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">### sampling steps array</span>
        <span class="n">sampling_arr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span> <span class="p">::</span> <span class="nb">int</span><span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="n">samplingfrequency</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">simulation_dt</span><span class="p">)]</span>

        <span class="c1">### generate multiple overlapping sequences</span>
        <span class="n">sampling_arr_sequences</span> <span class="o">=</span> <span class="n">_hanning_split_overlap</span><span class="p">(</span>
            <span class="n">sampling_arr</span><span class="p">,</span> <span class="n">fftSize</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">fftSize</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1">### generate power spectrum</span>
        <span class="n">spektrum</span> <span class="o">=</span> <span class="n">get_nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">sampling_arr_sequences</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">frequenzen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">fftSize</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">samplingfrequency</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">frequenzen</span><span class="p">[</span><span class="mi">2</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">fftSize</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">spektrum</span><span class="p">[</span><span class="mi">2</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">fftSize</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.get_pop_rate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_pop_rate</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">t_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t_smooth_ms</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.get_pop_rate" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Generates a smoothed population firing rate. Returns a time array and a firing rate
array.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>spikes</code></td>
          <td>
                <code>dictionary</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ANNarchy spike dict of one population</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>t_start</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>start time of analyzed data in ms. Default: time of first spike</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>t_end</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>end time of analyzed data in ms. Default: time of last spike</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>time_step</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>time step of the simulation in ms. Default: 1</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>t_smooth_ms</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>time window for firing rate calculation in ms, if -1 --&gt; time window sizes
are automatically detected. Default: -1</p>
            </div>
          </td>
          <td>
                <code>-1</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>time_arr</code></td>          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>array with time steps in ms</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>rate</code></td>          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>array with population rate in Hz for each time step</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_pop_rate</span><span class="p">(</span>
    <span class="n">spikes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">t_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">t_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">time_step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">t_smooth_ms</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a smoothed population firing rate. Returns a time array and a firing rate</span>
<span class="sd">    array.</span>

<span class="sd">    Args:</span>
<span class="sd">        spikes (dictionary):</span>
<span class="sd">            ANNarchy spike dict of one population</span>
<span class="sd">        t_start (float or int, optional):</span>
<span class="sd">            start time of analyzed data in ms. Default: time of first spike</span>
<span class="sd">        t_end (float or int, optional):</span>
<span class="sd">            end time of analyzed data in ms. Default: time of last spike</span>
<span class="sd">        time_step (float or int, optional):</span>
<span class="sd">            time step of the simulation in ms. Default: 1</span>
<span class="sd">        t_smooth_ms (float or int, optional):</span>
<span class="sd">            time window for firing rate calculation in ms, if -1 --&gt; time window sizes</span>
<span class="sd">            are automatically detected. Default: -1</span>

<span class="sd">    Returns:</span>
<span class="sd">        time_arr (array):</span>
<span class="sd">            array with time steps in ms</span>
<span class="sd">        rate (array):</span>
<span class="sd">            array with population rate in Hz for each time step</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">time_step</span>

    <span class="n">t</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">my_raster_plot</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>

    <span class="c1">### check if there are spikes in population at all</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">t_start</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t_start</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">*</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">get_number_of_decimals</span><span class="p">(</span><span class="n">time_step</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">t_end</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t_end</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">get_number_of_decimals</span><span class="p">(</span><span class="n">time_step</span><span class="p">))</span>

        <span class="n">duration</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">t_end</span> <span class="o">-</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">get_number_of_decimals</span><span class="p">(</span><span class="n">time_step</span><span class="p">))</span>

        <span class="c1">### if t_smooth is given --&gt; use classic time_window method</span>
        <span class="k">if</span> <span class="n">t_smooth_ms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_get_pop_rate_old</span><span class="p">(</span>
                <span class="n">spikes</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">t_start</span><span class="o">=</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_smooth_ms</span><span class="o">=</span><span class="n">t_smooth_ms</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">### concatenate all spike times and sort them</span>
            <span class="n">spike_arr</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spikes</span><span class="p">[</span><span class="n">neuron</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">neuron</span> <span class="ow">in</span> <span class="n">spikes</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">nr_neurons</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">spikes</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="n">nr_spikes</span> <span class="o">=</span> <span class="n">spike_arr</span><span class="o">.</span><span class="n">size</span>

            <span class="c1">### use _recursive_rate to get firing rate</span>
            <span class="c1">### spike array is splitted in time bins</span>
            <span class="c1">### time bins widths are automatically found</span>
            <span class="n">time_population_rate</span><span class="p">,</span> <span class="n">population_rate</span> <span class="o">=</span> <span class="n">_recursive_rate</span><span class="p">(</span>
                <span class="n">spike_arr</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span>
                <span class="n">t0</span><span class="o">=</span><span class="n">t_start</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span>
                <span class="n">t1</span><span class="o">=</span><span class="p">(</span><span class="n">t_start</span> <span class="o">+</span> <span class="n">duration</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span>
                <span class="n">duration_init</span><span class="o">=</span><span class="n">duration</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span>
                <span class="n">nr_neurons</span><span class="o">=</span><span class="n">nr_neurons</span><span class="p">,</span>
                <span class="n">nr_spikes</span><span class="o">=</span><span class="n">nr_spikes</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1">### time_population_rate was returned in s --&gt; transform it into ms</span>
            <span class="n">time_population_rate</span> <span class="o">=</span> <span class="n">time_population_rate</span> <span class="o">*</span> <span class="mi">1000</span>
            <span class="n">time_arr0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_start</span> <span class="o">+</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_population_rate</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1">### interpolate</span>
                <span class="n">interpolate_func</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
                    <span class="n">time_population_rate</span><span class="p">,</span>
                    <span class="n">population_rate</span><span class="p">,</span>
                    <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                    <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">fill_value</span><span class="o">=</span><span class="p">(</span><span class="n">population_rate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">population_rate</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                <span class="p">)</span>
                <span class="n">population_rate_arr</span> <span class="o">=</span> <span class="n">interpolate_func</span><span class="p">(</span><span class="n">time_arr0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">population_rate_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time_arr0</span><span class="p">))</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">time_arr0</span> <span class="o">==</span> <span class="n">time_population_rate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">population_rate_arr</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">population_rate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">ret</span> <span class="o">=</span> <span class="n">population_rate_arr</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">t_start</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">t_end</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">t_end</span> <span class="o">-</span> <span class="n">t_start</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">/</span> <span class="n">dt</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_start</span> <span class="o">+</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="p">),</span> <span class="n">ret</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.plot_recordings" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_recordings</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span> <span class="n">recordings</span><span class="p">,</span> <span class="n">recording_times</span><span class="p">,</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">plan</span><span class="p">,</span> <span class="n">time_lim</span><span class="o">=</span><span class="p">[],</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.plot_recordings" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Plots the recordings of a single chunk from recordings. Plotted variables are
specified in plan.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>figname</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>path + name of figure (e.g. "figures/my_figure.png")</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>recordings</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a recordings list from CompNeuroPy obtained with the function
get_recordings() from a CompNeuroMonitors object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>recording_times</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>recording_times object from CompNeuroPy obtained with the
function get_recording_times() from a CompNeuroMonitors object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>chunk</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>which chunk of recordings should be used (the index of chunk)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>shape</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Defines the subplot arrangement e.g. (3,2) = 3 rows, 2 columns</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>plan</code></td>
          <td>
                <code>list of strings</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Defines which recordings are plotted in which subplot and how.
Entries of the list have the structure:
    "subplot_nr;model_component_name;variable_to_plot;format",
    e.g. "1,my_pop1;v;line".
    mode: defines how the data is plotted, available modes:
        - for spike data: raster, mean, hybrid
        - for other data: line, mean, matrix
        - only for projection data: matrix_mean</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>time_lim</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Defines the x-axis for all subplots. The list contains two
numbers: start and end time in ms. The times have to be
within the chunk. Default: time lims of chunk</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>dpi</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dpi of the saved figure. Default: 300</p>
            </div>
          </td>
          <td>
                <code>300</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_recordings</span><span class="p">(</span>
    <span class="n">figname</span><span class="p">,</span> <span class="n">recordings</span><span class="p">,</span> <span class="n">recording_times</span><span class="p">,</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">plan</span><span class="p">,</span> <span class="n">time_lim</span><span class="o">=</span><span class="p">[],</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the recordings of a single chunk from recordings. Plotted variables are</span>
<span class="sd">    specified in plan.</span>

<span class="sd">    Args:</span>
<span class="sd">        figname (str):</span>
<span class="sd">            path + name of figure (e.g. &quot;figures/my_figure.png&quot;)</span>
<span class="sd">        recordings (list):</span>
<span class="sd">            a recordings list from CompNeuroPy obtained with the function</span>
<span class="sd">            get_recordings() from a CompNeuroMonitors object.</span>
<span class="sd">        recording_times (object):</span>
<span class="sd">            recording_times object from CompNeuroPy obtained with the</span>
<span class="sd">            function get_recording_times() from a CompNeuroMonitors object.</span>
<span class="sd">        chunk (int):</span>
<span class="sd">            which chunk of recordings should be used (the index of chunk)</span>
<span class="sd">        shape (tuple):</span>
<span class="sd">            Defines the subplot arrangement e.g. (3,2) = 3 rows, 2 columns</span>
<span class="sd">        plan (list of strings):</span>
<span class="sd">            Defines which recordings are plotted in which subplot and how.</span>
<span class="sd">            Entries of the list have the structure:</span>
<span class="sd">                &quot;subplot_nr;model_component_name;variable_to_plot;format&quot;,</span>
<span class="sd">                e.g. &quot;1,my_pop1;v;line&quot;.</span>
<span class="sd">                mode: defines how the data is plotted, available modes:</span>
<span class="sd">                    - for spike data: raster, mean, hybrid</span>
<span class="sd">                    - for other data: line, mean, matrix</span>
<span class="sd">                    - only for projection data: matrix_mean</span>
<span class="sd">        time_lim (list, optional):</span>
<span class="sd">            Defines the x-axis for all subplots. The list contains two</span>
<span class="sd">            numbers: start and end time in ms. The times have to be</span>
<span class="sd">            within the chunk. Default: time lims of chunk</span>
<span class="sd">        dpi (int, optional):</span>
<span class="sd">            The dpi of the saved figure. Default: 300</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proc</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="n">_plot_recordings</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span> <span class="n">recordings</span><span class="p">,</span> <span class="n">recording_times</span><span class="p">,</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">plan</span><span class="p">,</span> <span class="n">time_lim</span><span class="p">,</span> <span class="n">dpi</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">proc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">proc</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">proc</span><span class="o">.</span><span class="n">exitcode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">quit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.get_number_of_zero_decimals" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_number_of_zero_decimals</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.get_number_of_zero_decimals" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>For numbers which are smaller than zero get the number of digits after the decimal
point which are zero (plus 1). For the number 0 or numbers &gt;=1 return zero, e.g.:</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nr</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number from which the number of digits are obtained</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>decimals</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>number of digits after the decimal point which are zero (plus 1)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_number_of_zero_decimals</span><span class="p">(</span><span class="mf">0.12</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_number_of_zero_decimals</span><span class="p">(</span><span class="mf">0.012</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_number_of_zero_decimals</span><span class="p">(</span><span class="mf">1.012</span><span class="p">)</span>
<span class="go">0</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_number_of_zero_decimals</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For numbers which are smaller than zero get the number of digits after the decimal</span>
<span class="sd">    point which are zero (plus 1). For the number 0 or numbers &gt;=1 return zero, e.g.:</span>

<span class="sd">    Args:</span>
<span class="sd">        nr (float or int):</span>
<span class="sd">            the number from which the number of digits are obtained</span>

<span class="sd">    Returns:</span>
<span class="sd">        decimals (int):</span>
<span class="sd">            number of digits after the decimal point which are zero (plus 1)</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; get_number_of_zero_decimals(0.12)</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; get_number_of_zero_decimals(0.012)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; get_number_of_zero_decimals(1.012)</span>
<span class="sd">        0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">decimals</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">nr</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">nr</span> <span class="o">=</span> <span class="n">nr</span> <span class="o">*</span> <span class="mi">10</span>
            <span class="n">decimals</span> <span class="o">=</span> <span class="n">decimals</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">decimals</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.get_number_of_decimals" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_number_of_decimals</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.get_number_of_decimals" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get number of digits after the decimal point.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nr</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number from which the number of digits are obtained</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>decimals</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>number of digits after the decimal point</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_number_of_decimals</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_number_of_decimals</span><span class="p">(</span><span class="mf">5.1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_number_of_decimals</span><span class="p">(</span><span class="mf">0.0101</span><span class="p">)</span>
<span class="go">4</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_number_of_decimals</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get number of digits after the decimal point.</span>

<span class="sd">    Args:</span>
<span class="sd">        nr (float or int):</span>
<span class="sd">            the number from which the number of digits are obtained</span>

<span class="sd">    Returns:</span>
<span class="sd">        decimals (int):</span>
<span class="sd">            number of digits after the decimal point</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; get_number_of_decimals(5)</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; get_number_of_decimals(5.1)</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; get_number_of_decimals(0.0101)</span>
<span class="sd">        4</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">nr</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="n">decimals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">decimals</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">decimals</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.sample_data_with_timestep" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sample_data_with_timestep</span><span class="p">(</span><span class="n">time_arr</span><span class="p">,</span> <span class="n">data_arr</span><span class="p">,</span> <span class="n">timestep</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.sample_data_with_timestep" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Samples a data array each timestep using interpolation</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time_arr</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>times of data_arr in ms</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data_arr</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>array with data values from which will be sampled</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>timestep</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>timestep in ms for sampling</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>time_arr</code></td>          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>sampled time array</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>data_arr</code></td>          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>sampled data array</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sample_data_with_timestep</span><span class="p">(</span><span class="n">time_arr</span><span class="p">,</span> <span class="n">data_arr</span><span class="p">,</span> <span class="n">timestep</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Samples a data array each timestep using interpolation</span>

<span class="sd">    Args:</span>
<span class="sd">        time_arr (array):</span>
<span class="sd">            times of data_arr in ms</span>
<span class="sd">        data_arr (array):</span>
<span class="sd">            array with data values from which will be sampled</span>
<span class="sd">        timestep (float or int):</span>
<span class="sd">            timestep in ms for sampling</span>

<span class="sd">    Returns:</span>
<span class="sd">        time_arr (array):</span>
<span class="sd">            sampled time array</span>
<span class="sd">        data_arr (array):</span>
<span class="sd">            sampled data array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">interpolate_func</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
        <span class="n">time_arr</span><span class="p">,</span> <span class="n">data_arr</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span>
    <span class="p">)</span>
    <span class="n">min_time</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
        <span class="nb">round</span><span class="p">(</span><span class="n">time_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">timestep</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">timestep</span><span class="p">,</span>
        <span class="n">get_number_of_decimals</span><span class="p">(</span><span class="n">timestep</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">max_time</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
        <span class="nb">round</span><span class="p">(</span><span class="n">time_arr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">timestep</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">timestep</span><span class="p">,</span>
        <span class="n">get_number_of_decimals</span><span class="p">(</span><span class="n">timestep</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">new_time_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_time</span><span class="p">,</span> <span class="n">max_time</span> <span class="o">+</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">timestep</span><span class="p">)</span>
    <span class="n">new_data_arr</span> <span class="o">=</span> <span class="n">interpolate_func</span><span class="p">(</span><span class="n">new_time_arr</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">new_time_arr</span><span class="p">,</span> <span class="n">new_data_arr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.time_data_add_nan" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">time_data_add_nan</span><span class="p">(</span><span class="n">time_arr</span><span class="p">,</span> <span class="n">data_arr</span><span class="p">,</span> <span class="n">fill_time_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.time_data_add_nan" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>If there are gaps in time_arr --&gt; fill them with respective time values.
Fill the corresponding data_arr values with nan.</p>
<p>By default it is tried to fill the time array with continuously increasing times
based on the smallest time difference found there can still be discontinuities after
filling the arrays (because existing time values are not changed).</p>
<p>But one can also give a fixed fill time step.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time_arr</code></td>
          <td>
                <code>1D array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>times of data_arr in ms</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data_arr</code></td>
          <td>
                <code>nD array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the specified dimension of data array must have the same length
as time_arr</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fill_time_step</code></td>
          <td>
                <code>number, optional, default=None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if there are gaps they are filled with this time step</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>axis</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>which dimension of the data_arr belongs to the time_arr</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>time_arr</code></td>          <td>
                <code>1D array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>time array with gaps filled</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>data_arr</code></td>          <td>
                <code>nD array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>data array with gaps filled</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">time_data_add_nan</span><span class="p">(</span><span class="n">time_arr</span><span class="p">,</span> <span class="n">data_arr</span><span class="p">,</span> <span class="n">fill_time_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If there are gaps in time_arr --&gt; fill them with respective time values.</span>
<span class="sd">    Fill the corresponding data_arr values with nan.</span>

<span class="sd">    By default it is tried to fill the time array with continuously increasing times</span>
<span class="sd">    based on the smallest time difference found there can still be discontinuities after</span>
<span class="sd">    filling the arrays (because existing time values are not changed).</span>

<span class="sd">    But one can also give a fixed fill time step.</span>

<span class="sd">    Args:</span>
<span class="sd">        time_arr (1D array):</span>
<span class="sd">            times of data_arr in ms</span>
<span class="sd">        data_arr (nD array):</span>
<span class="sd">            the size of the specified dimension of data array must have the same length</span>
<span class="sd">            as time_arr</span>
<span class="sd">        fill_time_step (number, optional, default=None):</span>
<span class="sd">            if there are gaps they are filled with this time step</span>
<span class="sd">        axis (int):</span>
<span class="sd">            which dimension of the data_arr belongs to the time_arr</span>

<span class="sd">    Returns:</span>
<span class="sd">        time_arr (1D array):</span>
<span class="sd">            time array with gaps filled</span>
<span class="sd">        data_arr (nD array):</span>
<span class="sd">            data array with gaps filled</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">time_arr</span> <span class="o">=</span> <span class="n">time_arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">data_arr</span> <span class="o">=</span> <span class="n">data_arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">data_arr_shape</span> <span class="o">=</span> <span class="n">data_arr</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">if</span> <span class="n">data_arr_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">!=</span> <span class="n">time_arr</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;ERROR time_data_add_nan: time_arr must have same length as specified axis (default=0) of data_arr!&quot;</span>
        <span class="p">)</span>
        <span class="n">quit</span><span class="p">()</span>

    <span class="c1">### find gaps</span>
    <span class="n">time_diff_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time_arr</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fill_time_step</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="n">time_diff_min</span> <span class="o">=</span> <span class="n">time_diff_arr</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">time_diff_min</span> <span class="o">=</span> <span class="n">fill_time_step</span>
    <span class="n">gaps_arr</span> <span class="o">=</span> <span class="n">time_diff_arr</span> <span class="o">&gt;</span> <span class="n">time_diff_min</span>

    <span class="c1">### split arrays at gaps</span>
    <span class="n">time_arr_split</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
        <span class="n">time_arr</span><span class="p">,</span> <span class="n">indices_or_sections</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gaps_arr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>
    <span class="n">data_arr_split</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
        <span class="n">data_arr</span><span class="p">,</span> <span class="n">indices_or_sections</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gaps_arr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span>
    <span class="p">)</span>

    <span class="c1">### fill gaps between splits</span>
    <span class="n">data_arr_append_shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_arr_shape</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">split_arr_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time_arr_split</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1">### get gaps boundaries</span>
        <span class="n">current_end</span> <span class="o">=</span> <span class="n">time_arr_split</span><span class="p">[</span><span class="n">split_arr_idx</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">next_start</span> <span class="o">=</span> <span class="n">time_arr_split</span><span class="p">[</span><span class="n">split_arr_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">### create gap filling arrays</span>
        <span class="n">time_arr_append</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
            <span class="n">current_end</span> <span class="o">+</span> <span class="n">time_diff_min</span><span class="p">,</span> <span class="n">next_start</span><span class="p">,</span> <span class="n">time_diff_min</span>
        <span class="p">)</span>
        <span class="n">data_arr_append_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_arr_append</span><span class="o">.</span><span class="n">size</span>
        <span class="n">data_arr_append</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">data_arr_append_shape</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="c1">### append gap filling arrays to splitted arrays</span>
        <span class="n">time_arr_split</span><span class="p">[</span><span class="n">split_arr_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">arr</span><span class="o">=</span><span class="n">time_arr_split</span><span class="p">[</span><span class="n">split_arr_idx</span><span class="p">],</span>
            <span class="n">values</span><span class="o">=</span><span class="n">time_arr_append</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">data_arr_split</span><span class="p">[</span><span class="n">split_arr_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">arr</span><span class="o">=</span><span class="n">data_arr_split</span><span class="p">[</span><span class="n">split_arr_idx</span><span class="p">],</span>
            <span class="n">values</span><span class="o">=</span><span class="n">data_arr_append</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1">### combine splitted arrays again</span>
    <span class="n">time_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">time_arr_split</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">data_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">data_arr_split</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">time_arr</span><span class="p">,</span> <span class="n">data_arr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.rmse" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rmse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.rmse" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the root-mean-square error between two arrays.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>a</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>first array</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>b</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>second array</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>rmse</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>root-mean-square error</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the root-mean-square error between two arrays.</span>

<span class="sd">    Args:</span>
<span class="sd">        a (array):</span>
<span class="sd">            first array</span>
<span class="sd">        b (array):</span>
<span class="sd">            second array</span>

<span class="sd">    Returns:</span>
<span class="sd">        rmse (float):</span>
<span class="sd">            root-mean-square error</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.rsse" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rsse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.rsse" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the root-sum-square error between two arrays.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>a</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>first array</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>b</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>second array</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>rsse</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>root-sum-square error</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rsse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the root-sum-square error between two arrays.</span>

<span class="sd">    Args:</span>
<span class="sd">        a (array):</span>
<span class="sd">            first array</span>
<span class="sd">        b (array):</span>
<span class="sd">            second array</span>

<span class="sd">    Returns:</span>
<span class="sd">        rsse (float):</span>
<span class="sd">            root-sum-square error</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.get_minimum" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_minimum</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.get_minimum" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the minimum of the input data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_data</code></td>
          <td>
                <code>list, np.ndarray, tuple, or float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input data from which the minimum is to be obtained.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>minimum</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The minimum of the input data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_minimum</span><span class="p">(</span><span class="n">input_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the minimum of the input data.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_data (list, np.ndarray, tuple, or float):</span>
<span class="sd">            The input data from which the minimum is to be obtained.</span>

<span class="sd">    Returns:</span>
<span class="sd">        minimum (float):</span>
<span class="sd">            The minimum of the input data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="c1"># If the input is a list, numpy array, or tuple, we handle them as follows</span>
        <span class="n">flattened_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">item</span>
            <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">input_data</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="n">sublist</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sublist</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="k">else</span> <span class="p">[</span><span class="n">sublist</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">flattened_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If the input is a single value, return it as the minimum</span>
        <span class="k">return</span> <span class="n">input_data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.CompNeuroPy.analysis_functions.get_maximum" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_maximum</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span></code>

<a href="#src.CompNeuroPy.analysis_functions.get_maximum" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the maximum of the input data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_data</code></td>
          <td>
                <code>list, np.ndarray, tuple, or float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input data from which the maximum is to be obtained.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>maximum</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum of the input data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/CompNeuroPy/analysis_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_maximum</span><span class="p">(</span><span class="n">input_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the maximum of the input data.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_data (list, np.ndarray, tuple, or float):</span>
<span class="sd">            The input data from which the maximum is to be obtained.</span>

<span class="sd">    Returns:</span>
<span class="sd">        maximum (float):</span>
<span class="sd">            The maximum of the input data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="c1"># If the input is a list, numpy array, or tuple, we handle them as follows</span>
        <span class="n">flattened_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">item</span>
            <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">input_data</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="n">sublist</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sublist</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="k">else</span> <span class="p">[</span><span class="n">sublist</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">flattened_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If the input is a single value, return it as the maximum</span>
        <span class="k">return</span> <span class="n">input_data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Oliver Maith
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.cd18aaf1.min.js"></script>
      
    
  </body>
</html>